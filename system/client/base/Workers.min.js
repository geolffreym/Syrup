'use strict';(function(window) {function Workers() {this.Worker = null;this.interceptors = {};}Workers.add('run',function(url) {var self = this;return new Promise(function(resolve, reject) {self.Worker = new Worker(setting.system_path + url + '.js');self.Worker.addEventListener('message',function(e) {self._handleInterceptor('message',e);},false);resolve(self);});});Workers.add('get',function() {return this.Worker;});Workers.add('intercept',function(interceptors) {if (_.isObject(interceptors))MiddleWare.intercept(this,interceptors);return this;});Workers.add('interceptClean',function(type) {MiddleWare.cleanInterceptor(this,type);return this;});Workers.add('_handleInterceptor',function(type, param) {MiddleWare.trigger(MiddleWare.getInterceptors(this,type),[param,this]);});Workers.add('toWork',function(message) {this.Worker.postMessage(message || null);return this;});Workers.add('kill',function() {if (_.isSet(this.Worker)) {this.Worker.terminate();this.Worker = null;}return this;});window.Workers = Workers;})(window);
