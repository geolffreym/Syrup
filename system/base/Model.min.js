"use strict";(function(window){var WARNING_MODEL={ERROR:{NOPACK:"Error packing model",OBJECTNEEDED:"Object need to set in model"}};function Model(){this.data=null;this.blob=null;this.scope={};this.type="POST";this.model=null;this.failed=null}Model.add("method",function(method){this.type=method.toUpperCase();return this});Model.add("attach",function(name,attach){var self=this;_.assert(self.data,WARNING_MODEL.ERROR.NOPACK,"(Model .attach)");self.data.append(name,attach);return this});Model.add("multiple",function(name){var _return=[],_model_obj=this.model.get(0);if(name in _model_obj.elements){_.each(_model_obj.elements[name],function(v,i){_return.push(v.value)})}return _return.length>0?_return:false});Model.add("fail",function(field,error){this.failed=true;return{field:field,error:error,coords:_.cartesianPlane(field)}});Model.add("getScope",function(){return this.scope});Model.add("getData",function(){return this.data});Model.add("getBinaries",function(){return this.blob});Model.add("file",function(input){var _self=this,_formData=new FormData,_files=[],_field=!_.is$(input)&&_$(input).get(0)||input;return new Promise(function(resolve,reject){if(_field.type==="file"&&_.isSet(_field.name)){var _temp=_field.files,x=_temp.length;while(x--){_files[x]=_temp[x];_formData.append(_field.name,_temp[x])}}_self.scope["_files"]=_files;_self.blob=_formData;resolve(_self)})});Model.add("binary",function(model){var _self=this;_self.model=!_.is$(model)&&_$(model)||model;return new Promise(function(resolve,reject){_self.model.find('input[type="file"]',function(field){_self.file(field.get(0)).then(resolve)})})});Model.add("set",function(model,object){if(!_.isObject(object))_.error(WARNING_MODEL.ERROR.OBJECTNEEDED,"(Model .set)");var _self=this;_self.model=!_.is$(model)&&_$(model)||model;_.each(object,function(v,i){_self.model.find("input[name="+i+"]",function(e){_self.scope[i]=v;e.val(v)})})});Model.add("get",function(model){this.model=!_.is$(model)&&_$(model)||model;var _self=this,_modelData=new FormData,_field_array,_model_obj=_self.model.get(0),_fields=_model_obj.querySelectorAll("input, textarea, select"),x=_fields.length;_self.failed=false;return new Promise(function(resolve,reject){while(x--){if(!_fields[x])continue;if(_fields[x].type==="file"){_self.file(_fields[x]);continue}if(_fields[x].type==="checkbox"||_fields[x].type==="radio"){if(!_fields[x].checked){continue}}var field=_fields[x],fieldValue=field.value;if(!_$(field).data("skip")&&_.isEmpty(fieldValue)){reject(_self.fail(field,"empty"));break}else if(_$(field).data("mail")&&!_.isMail(fieldValue)){reject(_self.fail(field,"invalid_mail"));break}else if(_$(field).data("min")&&+_$(field).data("min")>fieldValue.length){reject(_self.fail(field,"minim_chars"));break}else if(_$(field).data("max")&&+_$(field).data("max")<fieldValue.length){reject(_self.fail(field,"overflow_chars"));break}else{if(_$(field).data("custom")){var Regex=new RegExp(_$(field).data("custom"),"g");if(!Regex.test(fieldValue)){reject(_self.fail(field,"invalid_custom"));break}}if(_.isSet(field.name)){if(!!(_field_array=_self.multiple(field.name)))fieldValue=_field_array;_modelData.append(field.name,fieldValue);_self.scope[field.name]=fieldValue}}}_self.data=_modelData;resolve(_self)})});window.Model=Model})(window);