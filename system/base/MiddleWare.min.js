(function(window) {'use strict';function MiddleWare() {}MiddleWare.add('intercept',function(intercepted, result) {return new Promise(function(resolve, reject) {if (!('interceptors'in intercepted))intercepted['interceptors'] = {};if (_.isObject(result)) {_.each(result,function(v, k) {if (!(k in intercepted.interceptors))intercepted.interceptors[k] = [];if (_.isFunction(v))intercepted.interceptors[k].push(v);});resolve(intercepted);}});});MiddleWare.add('extend',function(intercepted, to, extend) {if (!('interceptors'in intercepted[to]))intercepted[to]['interceptors'] = {};_.each(extend,function(v) {if (v !== to && v in intercepted) {if ('interceptors'in intercepted[v]) {_.each(intercepted[v].interceptors,function(r, i) {if (!(i in intercepted[to].interceptors))intercepted[to].interceptors[i] = [];intercepted[to].interceptors[i] = _.extend(intercepted[to].interceptors[i],r);});}}});});MiddleWare.add('getInterceptors',function(intercepted, find) {if (intercepted && 'interceptors'in intercepted) {if (find in intercepted.interceptors && _.isArray(intercepted.interceptors[find]) && intercepted.interceptors[find].length > 0) {return intercepted.interceptors[find];}}return [];});MiddleWare.add('cleanInterceptor',function(intercepted, find) {if (intercepted && 'interceptors'in intercepted) {if (find in intercepted.interceptors) {delete intercepted.interceptors[find];}}});MiddleWare.add('trigger',function(interceptors, params) {if (_.isArray(interceptors) && interceptors.length > 0)_.each(interceptors,function(v) {if (_.isFunction(v))v.apply(null,params || []);});});window.MiddleWare = new MiddleWare;window.MiddleWareClass = MiddleWare;})(window);
