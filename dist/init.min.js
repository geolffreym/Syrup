var setting={app_path:"/syrup/app",system_path:"/syrup/system",env:"development"};if(typeof exports!=="undefined")exports.setting=setting;"use strict";(function(windowGlobal){var nativeFunction=Function.prototype,nativeObject=Object.prototype,regexConstructor=/(([^function])([a-zA-z])+(?=\())/g,regexUrl=/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,regexMail=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,WARNING_SYRUP={ERROR:{NOPARAM:"Param needed",NONETWORK:"Network Error",NOOBJECT:"A object is needed.",NOARRAY:"A array is needed.",NOSTRING:"A string is needed",NOFUNCTION:"A function is needed.",NODATE:"Invalid Date",NOURL:"URL is needed."}};nativeObject.clone=function(){return _.extend({},this)};nativeObject.getIndex=function(index){return index in this?this[index]:null};nativeFunction.blend=function(child){var name=child.__proto__.constructor.name||child.prototype.constructor.name||child.toString().match(regexConstructor)[0].trim();this.prototype[name]=child};nativeFunction.factory=function(name){return new Function("return function "+name+"(){}")()};nativeFunction.add=function(name,fn){this.prototype[name.trim()]=fn};function Syrup(){}function _$_(){this.collection=null;this.exist=null;this.state=null}_$_.add("$",function(dom){var _tmp,_self=new _$_;if(_.isFunction(dom)){_$(document).ready(dom);return}if(_.isHtml(dom)){_tmp=document.createElement("div");_tmp.innerHTML=dom;_self.collection=_tmp.children.length>1?_tmp.children:_tmp.firstChild}else{_self.collection=!_.isObject(dom)&&_.isString(dom)?dom.indexOf("+")>-1?document.querySelectorAll(_.replace(dom,"+",_.emptyStr)):document.querySelector(dom):dom}_self.exist=_.isSet(_self.collection);_self.name=dom;return _self});_$_.add("ready",function(callback){if(_.isGlobal(this.collection))this.collection.addEventListener("DOMContentLoaded",callback.bind(this));return this});_$_.add("load",function(callback){if(_.isGlobal(this.collection)){this.collection.onload=callback.bind(this)}});_$_.add("listen",function(event,delegate,callback){if(_.isFunction(delegate)){callback=delegate}var _self=this,_target=null,_event=function(e){e=e||windowGlobal.event;_target=event.srcElement||e.target;if(_.isSet(delegate)&&!_.isFunction(delegate)){_$(_target).filter(delegate,function(){_.callbackAudit(callback.bind(_target),e)})}else{_.callbackAudit(callback.bind(_target),e)}};_self.each(function(elem){if(elem.addEventListener){elem.addEventListener(event,_event,true)}else if(elem.attachEvent){elem.attachEvent("on"+event,_event)}if(!_.isSet(elem["listListener"])){elem["listListener"]={}}elem.listListener[event]=_event});return this});_$_.add("listenOff",function(event){return this.each(function(elem){if(_.isSet(elem.listListener)){if(event in elem.listListener){if(elem.removeEventListener){elem.removeEventListener(event,elem.listListener[event],true)}else if(elem.detachEvent){elem.detachEvent("on"+event,elem.listListener[event])}delete elem.listListener[event]}}})});_$_.add("filter",function(filter,callback,e_handler){return this.each(function(elem){var match=elem.matchesSelector||elem.webkitMatchesSelector||elem.mozMatchesSelector||elem.oMatchesSelector||elem.msMatchesSelector;if(match.call(elem,filter)){_.callbackAudit(callback,_$(elem))}else if(_.isFunction(e_handler)){_.callbackAudit(e_handler,_$(elem))}})});_$_.add("empty",function(){return this.each(function(v){v.innerHTML=_.emptyStr})});_$_.add("clone",function(childs){childs=_.isSet(childs);var _clones=[];this.each(function(v){_clones.push(_$(v.cloneNode(childs)))});return _.specArray(_clones)});_$_.add("data",function(name,value){var _self=this,_data_set,_values=[];_self.each(function(dom,i){_data_set=dom.dataset;if(_.isSet(value)||_.isNumber(value)){_data_set[name]=_.isArray(value)?value[i]:value}else if(_.isSet(_data_set[name])){_values.push(_data_set[name])}});return _.specArray(_values)});_$_.add("prop",function(_prop){var _props=[];this.each(function(v){if(_.isString(_prop)){_props.push(v[_prop])}else if(_.isObject(_prop)){_.each(_prop,function(value,index){v[index]=value})}});return _.isString(_prop)?_.specArray(_props):this});_$_.add("attr",function(attr){var _attr=[];this.each(function(v){if(_.isString(attr)){_attr.push(v.getAttribute(attr))}else if(_.isObject(attr)){_.each(attr,function(value,index){v.setAttribute(index,value)})}});return _.isString(attr)?_.specArray(_attr):this});_$_.add("removeAttr",function(attr){return this.each(function(v){if(v[attr]){v[attr]=false}else{v.removeAttr(attr)}})});_$_.add("css",function(css){var _css=[],_self=this;_self.each(function(dom){if(_.isString(css)){var _style=windowGlobal.getComputedStyle(dom,null);_css.push(_style.getPropertyValue(css))}else if(_.isObject(dom)){_.each(css,function(value,index){dom.style[index]=value})}});return _.isString(css)?_.specArray(_css):this});_$_.add("after",function(elem){if(_.isHtml(elem)||!_.is$(elem)){elem=_$(elem)}return this.each(function(obj){elem.each(function(v){obj.parentNode.insertBefore(v,obj.nextSibling)})})});_$_.add("before",function(elem){if(_.isHtml(elem)||!_.is$(elem)){elem=_$(elem)}return this.each(function(obj){elem.each(function(v){obj.parentNode.insertBefore(v,obj)})})});_$_.add("append",function(childs){if(_.isHtml(childs)||!_.is$(childs)){childs=_$(childs)}return this.each(function(p){childs.each(function(elm){p.appendChild(elm)})})});_$_.add("prepend",function(childs){if(_.isHtml(childs)||!_.is$(childs)){childs=_$(childs)}return this.each(function(p){childs.each(function(elm){p.insertBefore(elm,p.firstChild)})})});_$_.add("html",function(html){if(_.isHtml(html)||_.isString(html)){this.prop({innerHTML:html})}else{return this.prop("innerHTML")}return this});_$_.add("text",function(text){if(_.isString(text)){this.prop({textContent:text})}else{return this.prop("textContent")}return this});_$_.add("val",function(text){if(_.isString(text)){this.prop({value:text})}else{return this.prop("value")}return this});_$_.add("hide",function(){return this.each(function(_elem){_elem.style.display="none"})});_$_.add("show",function(){return this.each(function(_elem){_elem.style.display="block"})});_$_.add("parent",function(callback){return this.each(function(_elem){if(_elem.parentNode)_.callbackAudit(callback,_$(_elem.parentNode))})});_$_.add("children",function(callback){return this.each(function(_elem){if(_elem.children.length>0){_.each(_elem.children,function(v,i){if(_.isNumber(i))_.callbackAudit(callback,_$(v))})}})});_$_.add("next",function(callback){return this.each(function(_elem){_.callbackAudit(callback,_$(_elem.nextElementSibling))})});_$_.add("nexts",function(filter,callback){var _sibling=null;callback=_.isFunction(filter)?filter:callback;return this.next(function(elem){_sibling=elem;do{if(_.isSet(filter)&&!_.isFunction(filter)){_sibling.filter(filter,function(elem){_.callbackAudit(callback,elem)})}else{_.callbackAudit(callback,_sibling)}}while((_sibling=_$(_sibling.get(0).nextElementSibling)).exist)})});_$_.add("trigger",function(event,callback){var _event=new CustomEvent(event,{bubbles:true,cancelable:true});if(document.createEvent){_event=document.createEvent("Event");_event.initEvent(event,true,false)}this.each(function(v){v.dispatchEvent(_event)});_.callbackAudit(callback,_event);return this});_$_.add("find",function(filter,callback){return this.children(function(elem){elem.filter(filter,function(e){_.callbackAudit(callback,e,filter)},function(){elem.find(filter,callback)})})});_$_.add("parents",function(parent_class,callback){return this.each(function(_elem){_$(_elem).parent(function(_parent){_parent.filter(parent_class,function(parent){_.callbackAudit(callback,parent)},function(){_parent.parents(parent_class,callback)})})})});_$_.add("hasClass",function(cls){_.assert(cls,WARNING_SYRUP.ERROR.NOPARAM,"($ .hasClass)");var elem=this.get(0);if(_.isSet(elem.classList)){if(Array.prototype.indexOf.call(elem.classList,cls)>-1){return true}}return false});_$_.add("addClass",function(cls){return this.each(function(elem){if(!_$(elem).hasClass(cls)){if(elem.classList){elem.classList.add(cls)}else{elem.className+=" "+cls}}})});_$_.add("toggleClass",function(cls){return this.each(function(elem){elem.classList.toggle(cls)})});_$_.add("removeClass",function(cls){return this.each(function(elem){if(_$(elem).hasClass(cls)){if(elem.classList){elem.classList.remove(cls)}else{elem.className=_.replace(elem.className,new RegExp(cls,"g"),_.emptyStr)}}})});_$_.add("fadeOut",function(delay,callback){this.animate([{opacity:"1"},{opacity:"0"}],{delay:0,duration:_.isNumber(delay)?delay:50},_.isFunction(delay)?delay:callback);return this});_$_.add("fadeIn",function(delay,callback){this.animate([{opacity:"0"},{opacity:"1"}],{delay:0,duration:_.isNumber(delay)?delay:50},_.isFunction(delay)?delay:callback);return this});_$_.add("height",function(height){if(_.isSet(height)){return this.css({height:_.isNumber(height)?height+"px":height})}var _height=[];this.each(function(elem){_height.push(_.cartesianPlane(elem).height)});return _.specArray(_height)});_$_.add("width",function(width){if(_.isSet(width)){return this.css({width:_.isNumber(width)?width+"px":width})}var _width=[];this.each(function(elem){_width.push(_.cartesianPlane(elem).width)});return _.specArray(_width)});_$_.add("is",function(context){_.assert(context,WARNING_SYRUP.ERROR.NOPARAM,"($ .is)");var v=this.get(0),_return=false;_$(v).filter(context,function(){_return=true},function(){_return=v[context]||v["type"]===context});return _return});_$_.add("get",function(find){if(_.objectAsString(this.collection)=="[object NodeList]"&&_.isNumber(find)){if(_.isSet(this.collection[find]))return this.collection[find]}return this.collection});_$_.add("remove",function(){return this.each(function(v){if(v.remove){v.remove()}else{v.parentNode.removeChild(v)}})});_$_.add("each",function(callback){var _element=this.collection;if("childNodes"in _element||_.isGlobal(_element)){_.callbackAudit(callback,_element,0)}else{_.each(_element,function(v,i,p){if(_.isObject(v)&&_.isSet(v)){_.callbackAudit(callback,v,i,p)}})}return this});_$_.add("offset",function(_object){var _offset=[];this.each(function(elem){var _cartesian=_.cartesianPlane(elem);if(_.isObject(_object)){if(_.isSet(_object.top))elem.style.top=_.isNumber(_object.top)?_object.top+"px":_object.top;if(_.isSet(_object.left))elem.style.left=_.isNumber(_object.left)?_object.left+"px":_object.left;if(_.isSet(_object.bottom))elem.style.bottom=_.isNumber(_object.bottom)?_object.bottom+"px":_object.bottom;if(_.isSet(_object.right))elem.style.right=_.isNumber(_object.right)?_object.right+"px":_object.right}_offset.push({top:_cartesian.top,left:_cartesian.left,bottom:_cartesian.bottom,right:_cartesian.right})});return _.specArray(_offset)});_$_.add("sort",function(_prop,_desc){if(_.isBoolean(_prop)){_desc=arguments[0];_prop=false}_desc=!_desc?1:-1;_prop=_prop?_prop:"innerHTML";return _.toArray(this.collection).sort(function(a,b){var _a=_$(a).attr(_prop)||_$(a).prop(_prop),_b=_$(b).attr(_prop)||_$(b).prop(_prop);if(_.isSet(_a)&&_.isSet(_b)){a=!isNaN(+_a)?+_a:_a.toLowerCase();b=!isNaN(+_b)?+_b:_b.toLowerCase()}return a>b?_desc:_desc*-1})});_$_.add("animate",function(prop,conf,callback){return this.each(function(elem){if(_.isSet(elem.animate)){if(_.isFunction(conf))callback=conf;conf=!_.isObject(conf)&&!_.isNumber(conf)?{}:conf;conf.iterations=_.isSet(conf.iterations)?conf.iterations:1;conf.duration=_.isSet(conf.duration)?conf.duration:1e3;conf.delay=_.isSet(conf.delay)?conf.delay:300;var _animation=elem.animate(prop,conf);_animation.addEventListener("finish",function(){_.callbackAudit(callback,_$(elem))})}})});_$_.add("object",function(){return this.collection});Syrup.add("noConflict",function(){return _$});Syrup.add("assert",function(obj,msg,breakpoint){if(!_.isSet(obj)){_.error(_.isSet(msg)?msg:"Param needed",breakpoint)}return this});Syrup.add("isArray",function(obj){return _.objectAsString(obj)==="[object Array]"});Syrup.add("isObject",function(obj){return _.objectAsString(obj)==="[object Object]"||typeof obj==="object"&&_.objectAsString(obj)!=="[object Null]"});Syrup.add("isGlobal",function(obj){return _.objectAsString(obj)==="[object global]"||_.objectAsString(obj)==="[object Window]"||_.objectAsString(obj)==="[object HTMLDocument]"||_.objectAsString(obj)==="[object Document]"});Syrup.add("is$",function(obj){return obj instanceof _$_});Syrup.add("isFormData",function(obj){return _.objectAsString(obj)==="[object FormData]"});Syrup.add("isString",function(obj){return _.objectAsString(obj)==="[object String]"});Syrup.add("isFunction",function(obj){return _.objectAsString(obj)==="[object Function]"});Syrup.add("isHtml",function(html){return/(<([^>]+)>)/gi.test(html)});Syrup.add("isBoolean",function(bool){return this.objectAsString(bool)==="[object Boolean]"});Syrup.add("isRegExp",function(regex){return this.objectAsString(regex)==="[object RegExp]"});Syrup.add("isSet",function(elm){return typeof elm!=="undefined"&&elm!==null&&!!elm});Syrup.add("isEmpty",function(input){if(_.isObject(input))return _.getObjectSize(input)==0;if(_.isArray(input))return input.length===0;return!input||input===_.emptyStr||/^\s+$/.test(input)});Syrup.add("isUrl",function(url){return regexUrl.test(url)});Syrup.add("isMail",function(mail){return regexMail.test(mail)});Syrup.add("isJson",function(str){try{JSON.parse(str)}catch(e){return false}return true});Syrup.add("isNumber",function(number){return!isNaN(number)});Syrup.add("warning",function(msg,breakpoint){console.log(msg+(breakpoint?" | Method: "+breakpoint:_.emptyStr))});Syrup.add("error",function(msg,breakpoint){throw msg+(breakpoint?" | Method: "+breakpoint:_.emptyStr)});Syrup.add("htmlEntities",function(str){var match={"<":"&lt",">":"&gt;",'"':"&quot;","'":"&#39;","&":"&amp;"};return _.replace(str,/<|>|&|"|'/g,match)});Syrup.add("truncateString",function(string,limit){return _.toObject(string).slice(0,limit)});Syrup.add("replace",function(_string,_find,_replace){if(_.isRegExp(_find)&&_.isObject(_replace)){return _string.replace(_find,function(found){if(found in _replace){return _replace[found]}return found})}else{return _string.replace(_find,_replace)}});Syrup.add("getDate",function(fecha){var _fecha=new Date,meridiano_,mes_=["January","February","March","April","May","June","July","August","September","October","November","December"],minutos_=_fecha.getMinutes(),hora_=_fecha.getHours(),segundos_=_fecha.getSeconds(),dia_=_fecha.getDate();_fecha=_.isSet(fecha)?new Date(fecha):_fecha;if(_fecha==="Invalid Date"){_.error(_fecha)}dia_=dia_<10?"0"+dia_:dia_;meridiano_=hora_>12?"PM":"AM";hora_=hora_>12?hora_-12===0?12:hora_-12:hora_<10?"0"+hora_:hora_;minutos_=minutos_<10?"0"+minutos_:minutos_;segundos_=segundos_<10?"0"+segundos_:segundos_;return{day:dia_,month:mes_[_fecha.getMonth()],year:_fecha.getFullYear(),hour:hora_,minutes:minutos_,seconds:segundos_,meridian:meridiano_}});Syrup.add("getNav",function(){var _regex=/(?:trident\/(?=\w.+rv:)|(?:chrome\/|firefox\/|opera\/|msie\s|safari\/))[\w.]{1,4}/,_matches=_.nav.local.match(_regex),_split=_.isSet(_matches)?_matches[0].split("/"):false;return _split?{nav:!!_split[0]?_.replace(_split[0],"trident","msie"):false,version:!!_split[1]?_split[1]:false,platform:windowGlobal.navigator.platform.toLocaleLowerCase()}:false});Syrup.add("getEncodedId",function(longitud){var _text=_.emptyStr,_longitud=!!longitud?longitud:5,_possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789=_";for(var i=0;i<_longitud;i++)_text+=_possible.charAt(Math.floor(Math.random()*_possible.length));return _text});Syrup.add("getObjectKeys",function(obj){if(_.isObject(obj)){return Object.keys(obj)}return[]});Syrup.add("getObjectSize",function(obj){if(_.isObject(obj)){return _.getObjectKeys(obj).length}return 0});Syrup.add("getObjectValues",function(obj){if(_.isObject(obj)){return _.getObjectKeys(obj).map(function(k){return obj[k]})}return[]});Syrup.add("objectAsString",function(obj){return nativeObject.toString.call(obj)});Syrup.add("objectImmutable",function(obj){if(_.isObject(obj))return Object.freeze(obj);return obj});Syrup.add("objectWatch",function(obj,callback,conf){if(_.isObject(obj)&&_.isSet(callback))Object.observe(obj,callback,conf?conf:[]);return obj});Syrup.add("interval",function(callback,conf){var _worker=new Workers;_worker.intercept({message:function(e){_.callbackAudit(callback,e.data)}}).run("/workers/setting/Interval").then(function(_worker){_worker.toWork(conf)});return _worker});Syrup.add("requestAnimationFrame",function(callback){return(windowGlobal.requestAnimationFrame||windowGlobal.webkitRequestAnimationFrame||windowGlobal.mozRequestAnimationFrame||function(call){windowGlobal.setTimeout(call,1e3/60)})(callback)});Syrup.add("getCookie",function(name){var _mcookie=document.cookie,_cookie=null;if(!!_mcookie&&_mcookie!==_.emptyStr){var cookies=_mcookie.split(";");_.each(cookies,function(cookie){cookie=cookie.split("=");var _pre=cookie[0].trim(),_pos=cookie[1].trim();if(_pre===name){_cookie=_pos;return false}})}return _cookie});Syrup.add("getRegExpGroup",function(string,regexp,groups){if(_.isString(string)&&_.isRegExp(regexp)){var _regex_exec=regexp.exec(string);return _regex_exec&&_regex_exec.reduce(function(v,m,i){if(i>0){v[groups[i-1]]=m}return v},{})||null}});Syrup.add("oChars",function(string,find){if(_.isString(string))return string.split(find).length-1;return 0});Syrup.add("simplifyDirectory",function(slashDir){if(_.isString(slashDir)){return slashDir.split("/").join(".")}return slashDir});Syrup.add("dotDirectory",function(dotDir){if(_.isString(dotDir)){return dotDir.split(".").join("/")}return dotDir});Syrup.add("jsonToQueryString",function(_object){var _return=_.emptyStr,_size=_.isObject(_object)?_.getObjectSize(_object):0;_.each(_object,function(value,key){_return+=encodeURI(key+"="+value);if(_size>1){_return+="&"}});return _return.lastIndexOf("&")>-1?_return.slice(0,-1):_return});Syrup.add("queryStringToJson",function(_string){var _return={};if(_.isString(_string)){_string=_.replace(_string,"?",_.emptyStr).split("&");_.each(_string,function(value){value=value.split("=");if(!_.isEmpty(value[0]))_return[value[0]]=value[1]||_.emptyStr})}return _return});Syrup.add("jsonToString",function(json){if(_.isObject(json))return JSON.stringify(json);return null});Syrup.add("getScript",function(url,callback){var _script=document.createElement("script"),_body=document.body,_loaded=function(){_$(_script).remove();_.callbackAudit(callback)};if(_.isSet(_script.readyState)){_script.addEventListener("readystatechange",function(){if(_script.readyState=="loaded"||_script.readyState=="complete"){_loaded()}},false)}else{_script.addEventListener("load",_loaded,false)}_script.src=url;_script.async=true;_body.appendChild(_script)});Syrup.add("each",function(_object,callback,noFilterF){var _p={first:false,last:false};if(_.isArray(_object)){var i=0,max=_object.length;for(;i<max;i++){_p.first=i===0;_p.last=i+1===max;callback&&noFilterF?callback(_object[i],i,_p):_.callbackAudit(callback,_object[i],i,_p)}}else{if(_.isObject(_object)){var _keys=Object.keys(_object),_tmp,_i=_tmp=_keys.length;while(_i--){_p.first=_i+1===_tmp;_p.last=_i===0;callback&&noFilterF?callback(_object[_keys[_i]],_keys[_i],_p):_.callbackAudit(callback,_object[_keys[_i]],_keys[_i],_p)}}}return this});Syrup.add("cartesianPlane",function(_dom,all){_dom=_.is$(_dom)?_$(_dom).object():_dom;if(_.isGlobal(_dom)){return{top:_dom.pageYOffset,left:_dom.pageXOffset,width:_dom.outerWidth,height:_dom.outerHeight}}return!!all?_dom.getClientRects():_dom.getBoundingClientRect()});Syrup.add("callbackAudit",function(callback){try{if(!_.isSet(callback)){return false}var _args=_.toArray(arguments);_args=_.filterArray(_args,function(v,i){return!_.isFunction(v)});callback.apply(null,_args.length>0?_args:null)}catch(e){_.error(e)}return true});Syrup.add("compactArray",function(arr){return _.filterArray(arr,function(i){return!!i?i:false})});Syrup.add("specArray",function(arr){if(!_.isArray(arr)){_.error(WARNING_SYRUP.ERROR.NOARRAY,"(Syrup .specArray)")}return arr.length>1?arr:_.isSet(arr[0])?arr[0]:null});Syrup.add("repeatString",function(str,times){return Array(times+1).join(str)});Syrup.add("filterArray",function(array,filter){return array.filter(filter)});Syrup.add("inObject",function(needle,haystack){var _exist=false;_.each(haystack,function(v,i){if(_.isObject(v)){_exist=_.inObject(needle,v);if(_exist){return false}}else{if(v===needle){_exist=i;return false}}});return _exist===0?true:_exist});Syrup.add("matchInArray",function(find,haystack){if(_.isArray(haystack)){var needle=new RegExp(haystack.join("|"),"g");return needle.test(find)}return false});Syrup.add("replaceInArray",function(find,replace,haystack){if(this.matchInArray(haystack,[find])){_.each(haystack,function(v,i){if(_.isString(v))haystack[i]=_.replace(v,find,replace)})}return haystack});Syrup.add("uniqueArray",function(array){var _new=[];return array.filter(function(v){if(_new.indexOf(v)==-1){_new.push(v);return v}})});Syrup.add("toArray",function(element){if(_.isObject(element)){return[].slice.apply(element)}else if(_.isString(element)){return _.toObject(element)}});Syrup.add("toString",function(element){if(_.isObject(element))return JSON.stringify(element)});Syrup.add("toRegExp",function(element){if(_.isString(element))return new RegExp(element)});Syrup.add("toObject",function(element,element2){if(_.isJson(element))return JSON.parse(element);if(_.isString(element))return nativeObject.valueOf.call(element);if(!_.isArray(element))_.error(WARNING_SYRUP.ERROR.NOARRAY,"(Syrup .toObject)");return element.reduce(function(o,v,i){o[element2&&v||i]=element2&&element2[i]||v;return o},{})});Syrup.add("objectDistribute",function(obj,index){var _new={};if(!_.isObject(obj[index])){_new[obj[index]]=obj}else{_.each(obj[index],function(v,i){_new[v]={};_.each(obj,function(r,j){if(j!==index){_new[v][j].push(r[i])}})})}return _new});Syrup.add("getElementIndex",function(node){node=_.is$(node)&&node.get()||node;var i=1,prop=document.body.previousElementSibling?"previousElementSibling":"previousSibling";while(node=node[prop]){++i}return i});Syrup.add("extend",function(target,source,overwrite){if(!_.isObject(target)||!source){return target}if(_.isFunction(source)){source=new source;target=target.__proto__}_.each(source,function(v,i){if(!target.hasOwnProperty(i)||_.isSet(overwrite)){target[i]=v}});return target});windowGlobal._=function(){return new Syrup}();windowGlobal._$=function(){return(new _$_).$}();_.VERSION="1.1.0";_.$fn=_$_;_.emptyStr="";_.Syrup=Syrup;_.WARNING_SYRUP=WARNING_SYRUP;_.nav={};_.nav.unsupported=!windowGlobal.localStorage||!windowGlobal.File||!windowGlobal.FileReader||!windowGlobal.FileList||!windowGlobal.Blob||!windowGlobal.Worker||!windowGlobal.WebSocket;_.nav.cookies=windowGlobal.navigator.cookieEnabled;_.nav.javascript=windowGlobal.navigator.javaEnabled();_.nav.online=windowGlobal.navigator.onLine;_.nav.local=windowGlobal.navigator.userAgent.toLowerCase()})(window);"use strict";(function(window){function Libs(){this.breadcrumb={};this.object=null;this.name=null}Libs.add("blend",function(name,dependencies){if(!(name in this.breadcrumb)){this.name=name;this.object=Function.factory(name);this._dependencies(dependencies);_.Syrup.blend(new this.object);this.breadcrumb[name]=_[name]}return this});Libs.add("get",function(name){return name in this.breadcrumb&&this.breadcrumb[name]});Libs.add("_dependencies",function(dependencies){var _self=this;if(_.isArray(dependencies)&&_.isSet(_self.object)){_.each(dependencies,function(v){_self.object.prototype[v]=!(v in _self.object)?_[v]||(_.isFunction(window[v])&&new window[v]||_.isFunction(window[v+"Class"])&&new window[v+"Class"]):_self.object.prototype[v]})}});Libs.add("make",function(attributes){var _self=this;_.each(attributes,function(v,i){_[_self.name][i]=v});return this});Libs.add("supply",function(supplier){var _self=this;_.each(supplier,function(v,i){if(_.isFunction(v))_self.cook(i,v)},true);return this});Libs.add("cook",function(name,callback){if(_.isFunction(callback))this.object.prototype[name]=callback;return this});window.Lib=new Libs;window.LibClass=Libs})(window);(function(window){"use strict";function MiddleWare(){}MiddleWare.add("intercept",function(intercepted,result){return new Promise(function(resolve,reject){if(!("interceptors"in intercepted))intercepted["interceptors"]={};if(_.isObject(result)){_.each(result,function(v,k){if(!(k in intercepted.interceptors))intercepted.interceptors[k]=[];if(_.isFunction(v))intercepted.interceptors[k].push(v)},true);resolve(intercepted)}})});MiddleWare.add("getInterceptors",function(intercepted,find){if("interceptors"in intercepted){if(find in intercepted.interceptors&&_.isArray(intercepted.interceptors[find])&&intercepted.interceptors[find].length>0){return intercepted.interceptors[find]}}return[]});MiddleWare.add("cleanInterceptor",function(intercepted,find){if("interceptors"in intercepted){if(find in intercepted.interceptors){delete intercepted.interceptors[find]}}});MiddleWare.add("trigger",function(interceptors,params){if(interceptors.length>0)_.each(interceptors,function(v){if(_.isFunction(v))v.apply(null,params||[])},true)});window.MiddleWare=new MiddleWare;window.MiddleWareClass=MiddleWare})(window);if(!Object.observe){(function(extend,global){"use strict";var isCallable=function(toString){var s=toString.call(toString),u=typeof u;return typeof global.alert==="object"?function isCallable(f){return s===toString.call(f)||!!f&&typeof f.toString==u&&typeof f.valueOf==u&&/^\s*\bfunction\b/.test(""+f)}:function isCallable(f){return s===toString.call(f)}}(extend.prototype.toString);var isNode=function isNode(o){return typeof Node==="object"?o instanceof Node:o&&typeof o==="object"&&typeof o.nodeType==="number"&&typeof o.nodeName==="string"};var isElement=function isElement(o){return typeof HTMLElement==="object"?o instanceof HTMLElement:o&&typeof o==="object"&&o!==null&&o.nodeType===1&&typeof o.nodeName==="string"};var _isImmediateSupported=function(){return!!global.setImmediate}();var _doCheckCallback=function(){if(_isImmediateSupported){return function _doCheckCallback(f){return setImmediate(f)}}else{return function _doCheckCallback(f){return setTimeout(f,10)}}}();var _clearCheckCallback=function(){if(_isImmediateSupported){return function _clearCheckCallback(id){clearImmediate(id)}}else{return function _clearCheckCallback(id){clearTimeout(id)}}}();var isNumeric=function isNumeric(n){return!isNaN(parseFloat(n))&&isFinite(n)};var sameValue=function sameValue(x,y){if(x===y){return x!==0||1/x===1/y}return x!==x&&y!==y};var isAccessorDescriptor=function isAccessorDescriptor(desc){if(typeof desc==="undefined"){return false}return"get"in desc||"set"in desc};var isDataDescriptor=function isDataDescriptor(desc){if(typeof desc==="undefined"){return false}return"value"in desc||"writable"in desc};var validateArguments=function validateArguments(O,callback,accept){if(typeof O!=="object"){throw new TypeError("Object.observeObject called on non-object")}if(isCallable(callback)===false){throw new TypeError("Object.observeObject: Expecting function")}if(Object.isFrozen(callback)===true){throw new TypeError("Object.observeObject: Expecting unfrozen function")}if(accept!==undefined){if(!Array.isArray(accept)){throw new TypeError("Object.observeObject: Expecting acceptList in the form of an array")}}};var Observer=function Observer(){var wraped=[];var Observer=function Observer(O,callback,accept){validateArguments(O,callback,accept);if(!accept){accept=["add","update","delete","reconfigure","setPrototype","preventExtensions"]}Object.getNotifier(O).addListener(callback,accept);if(wraped.indexOf(O)===-1){wraped.push(O)}else{Object.getNotifier(O)._checkPropertyListing()}};Observer.prototype.deliverChangeRecords=function Observer_deliverChangeRecords(O){Object.getNotifier(O).deliverChangeRecords()};wraped.lastScanned=0;var f=function f(wrapped){return function _f(){var i=0,l=wrapped.length,startTime=new Date,takingTooLong=false;for(i=wrapped.lastScanned;i<l&&!takingTooLong;i++){if(_indexes.indexOf(wrapped[i])>-1){Object.getNotifier(wrapped[i])._checkPropertyListing();takingTooLong=new Date-startTime>100}else{wrapped.splice(i,1);i--;l--}}wrapped.lastScanned=i<l?i:0;_doCheckCallback(_f)}}(wraped);_doCheckCallback(f);return Observer}();var Notifier=function Notifier(watching){var _listeners=[],_acceptLists=[],_updates=[],_updater=false,properties=[],values=[];var self=this;Object.defineProperty(self,"_watching",{enumerable:true,get:function(watched){return function(){return watched}}(watching)});var wrapProperty=function wrapProperty(object,prop){var propType=typeof object[prop],descriptor=Object.getOwnPropertyDescriptor(object,prop);if(prop==="getNotifier"||isAccessorDescriptor(descriptor)||!descriptor.enumerable){return false}if(object instanceof Array&&isNumeric(prop)){var idx=properties.length;properties[idx]=prop;values[idx]=object[prop];return true}(function(idx,prop){properties[idx]=prop;values[idx]=object[prop];function getter(){return values[getter.info.idx]}function setter(value){if(!sameValue(values[setter.info.idx],value)){Object.getNotifier(object).queueUpdate(object,prop,"update",values[setter.info.idx]);values[setter.info.idx]=value}}getter.info=setter.info={idx:idx};Object.defineProperty(object,prop,{get:getter,set:setter})})(properties.length,prop);return true};self._checkPropertyListing=function _checkPropertyListing(dontQueueUpdates){var object=self._watching,keys=Object.keys(object),i=0,l=keys.length;var newKeys=[],oldKeys=properties.slice(0),updates=[];var prop,queueUpdates=!dontQueueUpdates,propType,value,idx,aLength;if(object instanceof Array){aLength=self._oldLength}for(i=0;i<l;i++){prop=keys[i];value=object[prop];propType=typeof value;if((idx=properties.indexOf(prop))===-1){if(wrapProperty(object,prop)&&queueUpdates){self.queueUpdate(object,prop,"add",null,object[prop])}}else{if(!(object instanceof Array)||isNumeric(prop)){if(values[idx]!==value){if(queueUpdates){self.queueUpdate(object,prop,"update",values[idx],value)}values[idx]=value}}oldKeys.splice(oldKeys.indexOf(prop),1)}}if(object instanceof Array&&object.length!==aLength){if(queueUpdates){self.queueUpdate(object,"length","update",aLength,object)}self._oldLength=object.length}if(queueUpdates){l=oldKeys.length;for(i=0;i<l;i++){idx=properties.indexOf(oldKeys[i]);self.queueUpdate(object,oldKeys[i],"delete",values[idx]);properties.splice(idx,1);values.splice(idx,1);for(var i=idx;i<properties.length;i++){if(!(properties[i]in object))continue;var getter=Object.getOwnPropertyDescriptor(object,properties[i]).get;if(!getter)continue;var info=getter.info;info.idx=i}}}};self.addListener=function Notifier_addListener(callback,accept){var idx=_listeners.indexOf(callback);if(idx===-1){_listeners.push(callback);_acceptLists.push(accept)}else{_acceptLists[idx]=accept}};self.removeListener=function Notifier_removeListener(callback){
var idx=_listeners.indexOf(callback);if(idx>-1){_listeners.splice(idx,1);_acceptLists.splice(idx,1)}};self.listeners=function Notifier_listeners(){return _listeners};self.queueUpdate=function Notifier_queueUpdate(what,prop,type,was){this.queueUpdates([{type:type,object:what,name:prop,oldValue:was}])};self.queueUpdates=function Notifier_queueUpdates(updates){var self=this,i=0,l=updates.length||0,update;for(i=0;i<l;i++){update=updates[i];_updates.push(update)}if(_updater){_clearCheckCallback(_updater)}_updater=_doCheckCallback(function(){_updater=false;self.deliverChangeRecords()})};self.deliverChangeRecords=function Notifier_deliverChangeRecords(){var i=0,l=_listeners.length,retval;for(i=0;i<l;i++){if(_listeners[i]){var currentUpdates;if(_acceptLists[i]){currentUpdates=[];for(var j=0,updatesLength=_updates.length;j<updatesLength;j++){if(_acceptLists[i].indexOf(_updates[j].type)!==-1){currentUpdates.push(_updates[j])}}}else{currentUpdates=_updates}if(currentUpdates.length){if(_listeners[i]===console.log){console.log(currentUpdates)}else{_listeners[i](currentUpdates)}}}}_updates=[]};self.notify=function Notifier_notify(changeRecord){if(typeof changeRecord!=="object"||typeof changeRecord.type!=="string"){throw new TypeError("Invalid changeRecord with non-string 'type' property")}changeRecord.object=watching;self.queueUpdates([changeRecord])};self._checkPropertyListing(true)};var _notifiers=[],_indexes=[];extend.getNotifier=function Object_getNotifier(O){var idx=_indexes.indexOf(O),notifier=idx>-1?_notifiers[idx]:false;if(!notifier){idx=_indexes.length;_indexes[idx]=O;notifier=_notifiers[idx]=new Notifier(O)}return notifier};extend.observe=function Object_observe(O,callback,accept){if(!isElement(O)){return new Observer(O,callback,accept)}};extend.unobserve=function Object_unobserve(O,callback){validateArguments(O,callback);var idx=_indexes.indexOf(O),notifier=idx>-1?_notifiers[idx]:false;if(!notifier){return}notifier.removeListener(callback);if(notifier.listeners().length===0){_indexes.splice(idx,1);_notifiers.splice(idx,1)}}})(Object,this)}(function(window){"use strict";function Required(){var requirejs,require,define;(function(global){var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.20",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,isBrowser=!!(typeof window!=="undefined"&&typeof navigator!=="undefined"&&window.document),isWebWorker=!isBrowser&&typeof importScripts!=="undefined",readyRegExp=isBrowser&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera=typeof opera!=="undefined"&&opera.toString()==="[object Opera]",contexts={},cfg={},globalDefQueue=[],useInteractive=false;function isFunction(it){return ostring.call(it)==="[object Function]"}function isArray(it){return ostring.call(it)==="[object Array]"}function each(ary,func){if(ary){var i;for(i=0;i<ary.length;i+=1){if(ary[i]&&func(ary[i],i,ary)){break}}}}function eachReverse(ary,func){if(ary){var i;for(i=ary.length-1;i>-1;i-=1){if(ary[i]&&func(ary[i],i,ary)){break}}}}function hasProp(obj,prop){return hasOwn.call(obj,prop)}function getOwn(obj,prop){return hasProp(obj,prop)&&obj[prop]}function eachProp(obj,func){var prop;for(prop in obj){if(hasProp(obj,prop)){if(func(obj[prop],prop)){break}}}}function mixin(target,source,force,deepStringMixin){if(source){eachProp(source,function(value,prop){if(force||!hasProp(target,prop)){if(deepStringMixin&&typeof value==="object"&&value&&!isArray(value)&&!isFunction(value)&&!(value instanceof RegExp)){if(!target[prop]){target[prop]={}}mixin(target[prop],value,force,deepStringMixin)}else{target[prop]=value}}})}return target}function bind(obj,fn){return function(){return fn.apply(obj,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(err){throw err}function getGlobal(value){if(!value){return value}var g=global;each(value.split("."),function(part){g=g[part]});return g}function makeError(id,msg,err,requireModules){var e=new Error(msg+"\nhttp://requirejs.org/docs/errors.html#"+id);e.requireType=id;e.requireModules=requireModules;if(err){e.originalError=err}return e}if(typeof define!=="undefined"){return}if(typeof requirejs!=="undefined"){if(isFunction(requirejs)){return}cfg=requirejs;requirejs=undefined}if(typeof require!=="undefined"&&!isFunction(require)){cfg=require;require=undefined}function newContext(contextName){var inCheckLoaded,Module,context,handlers,checkLoadedTimeoutId,config={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},registry={},enabledRegistry={},undefEvents={},defQueue=[],defined={},urlFetched={},bundlesMap={},requireCounter=1,unnormalizedCounter=1;function trimDots(ary){var i,part;for(i=0;i<ary.length;i++){part=ary[i];if(part==="."){ary.splice(i,1);i-=1}else if(part===".."){if(i===0||i===1&&ary[2]===".."||ary[i-1]===".."){continue}else if(i>0){ary.splice(i-1,2);i-=2}}}}function normalize(name,baseName,applyMap){var pkgMain,mapValue,nameParts,i,j,nameSegment,lastIndex,foundMap,foundI,foundStarMap,starI,normalizedBaseParts,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"];if(name){name=name.split("/");lastIndex=name.length-1;if(config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])){name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"")}if(name[0].charAt(0)==="."&&baseParts){normalizedBaseParts=baseParts.slice(0,baseParts.length-1);name=normalizedBaseParts.concat(name)}trimDots(name);name=name.join("/")}if(applyMap&&map&&(baseParts||starMap)){nameParts=name.split("/");outerLoop:for(i=nameParts.length;i>0;i-=1){nameSegment=nameParts.slice(0,i).join("/");if(baseParts){for(j=baseParts.length;j>0;j-=1){mapValue=getOwn(map,baseParts.slice(0,j).join("/"));if(mapValue){mapValue=getOwn(mapValue,nameSegment);if(mapValue){foundMap=mapValue;foundI=i;break outerLoop}}}}if(!foundStarMap&&starMap&&getOwn(starMap,nameSegment)){foundStarMap=getOwn(starMap,nameSegment);starI=i}}if(!foundMap&&foundStarMap){foundMap=foundStarMap;foundI=starI}if(foundMap){nameParts.splice(0,foundI,foundMap);name=nameParts.join("/")}}pkgMain=getOwn(config.pkgs,name);return pkgMain?pkgMain:name}function removeScript(name){if(isBrowser){each(scripts(),function(scriptNode){if(scriptNode.getAttribute("data-requiremodule")===name&&scriptNode.getAttribute("data-requirecontext")===context.contextName){scriptNode.parentNode.removeChild(scriptNode);return true}})}}function hasPathFallback(id){var pathConfig=getOwn(config.paths,id);if(pathConfig&&isArray(pathConfig)&&pathConfig.length>1){pathConfig.shift();context.require.undef(id);context.makeRequire(null,{skipMap:true})([id]);return true}}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;if(index>-1){prefix=name.substring(0,index);name=name.substring(index+1,name.length)}return[prefix,name]}function makeModuleMap(name,parentModuleMap,isNormalized,applyMap){var url,pluginModule,suffix,nameParts,prefix=null,parentName=parentModuleMap?parentModuleMap.name:null,originalName=name,isDefine=true,normalizedName="";if(!name){isDefine=false;name="_@r"+(requireCounter+=1)}nameParts=splitPrefix(name);prefix=nameParts[0];name=nameParts[1];if(prefix){prefix=normalize(prefix,parentName,applyMap);pluginModule=getOwn(defined,prefix)}if(name){if(prefix){if(pluginModule&&pluginModule.normalize){normalizedName=pluginModule.normalize(name,function(name){return normalize(name,parentName,applyMap)})}else{normalizedName=name.indexOf("!")===-1?normalize(name,parentName,applyMap):name}}else{normalizedName=normalize(name,parentName,applyMap);nameParts=splitPrefix(normalizedName);prefix=nameParts[0];normalizedName=nameParts[1];isNormalized=true;url=context.nameToUrl(normalizedName)}}suffix=prefix&&!pluginModule&&!isNormalized?"_unnormalized"+(unnormalizedCounter+=1):"";return{prefix:prefix,name:normalizedName,parentMap:parentModuleMap,unnormalized:!!suffix,url:url,originalName:originalName,isDefine:isDefine,id:(prefix?prefix+"!"+normalizedName:normalizedName)+suffix}}function getModule(depMap){var id=depMap.id,mod=getOwn(registry,id);if(!mod){mod=registry[id]=new context.Module(depMap)}return mod}function on(depMap,name,fn){var id=depMap.id,mod=getOwn(registry,id);if(hasProp(defined,id)&&(!mod||mod.defineEmitComplete)){if(name==="defined"){fn(defined[id])}}else{mod=getModule(depMap);if(mod.error&&name==="error"){fn(mod.error)}else{mod.on(name,fn)}}}function onError(err,errback){var ids=err.requireModules,notified=false;if(errback){errback(err)}else{each(ids,function(id){var mod=getOwn(registry,id);if(mod){mod.error=err;if(mod.events.error){notified=true;mod.emit("error",err)}}});if(!notified){req.onError(err)}}}function takeGlobalQueue(){if(globalDefQueue.length){each(globalDefQueue,function(queueItem){var id=queueItem[0];if(typeof id==="string"){context.defQueueMap[id]=true}defQueue.push(queueItem)});globalDefQueue=[]}}handlers={require:function(mod){if(mod.require){return mod.require}else{return mod.require=context.makeRequire(mod.map)}},exports:function(mod){mod.usingExports=true;if(mod.map.isDefine){if(mod.exports){return defined[mod.map.id]=mod.exports}else{return mod.exports=defined[mod.map.id]={}}}},module:function(mod){if(mod.module){return mod.module}else{return mod.module={id:mod.map.id,uri:mod.map.url,config:function(){return getOwn(config.config,mod.map.id)||{}},exports:mod.exports||(mod.exports={})}}}};function cleanRegistry(id){delete registry[id];delete enabledRegistry[id]}function breakCycle(mod,traced,processed){var id=mod.map.id;if(mod.error){mod.emit("error",mod.error)}else{traced[id]=true;each(mod.depMaps,function(depMap,i){var depId=depMap.id,dep=getOwn(registry,depId);if(dep&&!mod.depMatched[i]&&!processed[depId]){if(getOwn(traced,depId)){mod.defineDep(i,defined[depId]);mod.check()}else{breakCycle(dep,traced,processed)}}});processed[id]=true}}function checkLoaded(){var err,usingPathFallback,waitInterval=config.waitSeconds*1e3,expired=waitInterval&&context.startTime+waitInterval<(new Date).getTime(),noLoads=[],reqCalls=[],stillLoading=false,needCycleCheck=true;if(inCheckLoaded){return}inCheckLoaded=true;eachProp(enabledRegistry,function(mod){var map=mod.map,modId=map.id;if(!mod.enabled){return}if(!map.isDefine){reqCalls.push(mod)}if(!mod.error){if(!mod.inited&&expired){if(hasPathFallback(modId)){usingPathFallback=true;stillLoading=true}else{noLoads.push(modId);removeScript(modId)}}else if(!mod.inited&&mod.fetched&&map.isDefine){stillLoading=true;if(!map.prefix){return needCycleCheck=false}}}});if(expired&&noLoads.length){err=makeError("timeout","Load timeout for modules: "+noLoads,null,noLoads);err.contextName=context.contextName;return onError(err)}if(needCycleCheck){each(reqCalls,function(mod){breakCycle(mod,{},{})})}if((!expired||usingPathFallback)&&stillLoading){if((isBrowser||isWebWorker)&&!checkLoadedTimeoutId){checkLoadedTimeoutId=setTimeout(function(){checkLoadedTimeoutId=0;checkLoaded()},50)}}inCheckLoaded=false}Module=function(map){this.events=getOwn(undefEvents,map.id)||{};this.map=map;this.shim=getOwn(config.shim,map.id);this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0};Module.prototype={init:function(depMaps,factory,errback,options){options=options||{};if(this.inited){return}this.factory=factory;if(errback){this.on("error",errback)}else if(this.events.error){errback=bind(this,function(err){this.emit("error",err)})}this.depMaps=depMaps&&depMaps.slice(0);this.errback=errback;this.inited=true;this.ignore=options.ignore;if(options.enabled||this.enabled){this.enable()}else{this.check()}},defineDep:function(i,depExports){if(!this.depMatched[i]){this.depMatched[i]=true;this.depCount-=1;this.depExports[i]=depExports}},fetch:function(){if(this.fetched){return}this.fetched=true;context.startTime=(new Date).getTime();var map=this.map;if(this.shim){context.makeRequire(this.map,{enableBuildCallback:true})(this.shim.deps||[],bind(this,function(){return map.prefix?this.callPlugin():this.load()}))}else{return map.prefix?this.callPlugin():this.load()}},load:function(){var url=this.map.url;if(!urlFetched[url]){urlFetched[url]=true;context.load(this.map.id,url)}},check:function(){if(!this.enabled||this.enabling){return}var err,cjsModule,id=this.map.id,depExports=this.depExports,exports=this.exports,factory=this.factory;if(!this.inited){if(!hasProp(context.defQueueMap,id)){this.fetch()}}else if(this.error){this.emit("error",this.error)}else if(!this.defining){this.defining=true;if(this.depCount<1&&!this.defined){if(isFunction(factory)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError){try{exports=context.execCb(id,factory,depExports,exports)}catch(e){err=e}}else{exports=context.execCb(id,factory,depExports,exports)}if(this.map.isDefine&&exports===undefined){cjsModule=this.module;if(cjsModule){exports=cjsModule.exports}else if(this.usingExports){exports=this.exports}}if(err){err.requireMap=this.map;err.requireModules=this.map.isDefine?[this.map.id]:null;err.requireType=this.map.isDefine?"define":"require";return onError(this.error=err)}}else{exports=factory}this.exports=exports;if(this.map.isDefine&&!this.ignore){defined[id]=exports;if(req.onResourceLoad){req.onResourceLoad(context,this.map,this.depMaps)}}cleanRegistry(id);this.defined=true}this.defining=false;if(this.defined&&!this.defineEmitted){this.defineEmitted=true;this.emit("defined",this.exports);this.defineEmitComplete=true}}},callPlugin:function(){var map=this.map,id=map.id,pluginMap=makeModuleMap(map.prefix);this.depMaps.push(pluginMap);on(pluginMap,"defined",bind(this,function(plugin){var load,normalizedMap,normalizedMod,bundleId=getOwn(bundlesMap,this.map.id),name=this.map.name,parentName=this.map.parentMap?this.map.parentMap.name:null,localRequire=context.makeRequire(map.parentMap,{enableBuildCallback:true});if(this.map.unnormalized){if(plugin.normalize){name=plugin.normalize(name,function(name){return normalize(name,parentName,true)})||""}normalizedMap=makeModuleMap(map.prefix+"!"+name,this.map.parentMap);on(normalizedMap,"defined",bind(this,function(value){this.init([],function(){return value},null,{enabled:true,ignore:true})}));normalizedMod=getOwn(registry,normalizedMap.id);if(normalizedMod){this.depMaps.push(normalizedMap);if(this.events.error){normalizedMod.on("error",bind(this,function(err){this.emit("error",err)}))}normalizedMod.enable()}return}if(bundleId){this.map.url=context.nameToUrl(bundleId);this.load();return}load=bind(this,function(value){this.init([],function(){return value},null,{enabled:true})});load.error=bind(this,function(err){this.inited=true;this.error=err;err.requireModules=[id];eachProp(registry,function(mod){if(mod.map.id.indexOf(id+"_unnormalized")===0){cleanRegistry(mod.map.id)}});onError(err)});load.fromText=bind(this,function(text,textAlt){var moduleName=map.name,moduleMap=makeModuleMap(moduleName),hasInteractive=useInteractive;if(textAlt){text=textAlt}if(hasInteractive){useInteractive=false}getModule(moduleMap);if(hasProp(config.config,id)){config.config[moduleName]=config.config[id]}try{req.exec(text)}catch(e){return onError(makeError("fromtexteval","fromText eval for "+id+" failed: "+e,e,[id]))}if(hasInteractive){useInteractive=true}this.depMaps.push(moduleMap);context.completeLoad(moduleName);localRequire([moduleName],load)});plugin.load(map.name,localRequire,load,config)}));context.enable(pluginMap,this);this.pluginMaps[pluginMap.id]=pluginMap},enable:function(){enabledRegistry[this.map.id]=this;this.enabled=true;this.enabling=true;each(this.depMaps,bind(this,function(depMap,i){var id,mod,handler;if(typeof depMap==="string"){depMap=makeModuleMap(depMap,this.map.isDefine?this.map:this.map.parentMap,false,!this.skipMap);this.depMaps[i]=depMap;handler=getOwn(handlers,depMap.id);if(handler){this.depExports[i]=handler(this);return}this.depCount+=1;on(depMap,"defined",bind(this,function(depExports){if(this.undefed){return}this.defineDep(i,depExports);this.check()}));if(this.errback){on(depMap,"error",bind(this,this.errback))}else if(this.events.error){on(depMap,"error",bind(this,function(err){this.emit("error",err)}))}}id=depMap.id;mod=registry[id];if(!hasProp(handlers,id)&&mod&&!mod.enabled){context.enable(depMap,this)}}));eachProp(this.pluginMaps,bind(this,function(pluginMap){var mod=getOwn(registry,pluginMap.id);if(mod&&!mod.enabled){context.enable(pluginMap,this)}}));this.enabling=false;this.check()},on:function(name,cb){var cbs=this.events[name];if(!cbs){cbs=this.events[name]=[]}cbs.push(cb)},emit:function(name,evt){each(this.events[name],function(cb){cb(evt)});if(name==="error"){delete this.events[name]}}};function callGetModule(args){if(!hasProp(defined,args[0])){getModule(makeModuleMap(args[0],null,true)).init(args[1],args[2])}}function removeListener(node,func,name,ieName){if(node.detachEvent&&!isOpera){if(ieName){node.detachEvent(ieName,func)}}else{node.removeEventListener(name,func,false)}}function getScriptData(evt){var node=evt.currentTarget||evt.srcElement;removeListener(node,context.onScriptLoad,"load","onreadystatechange");removeListener(node,context.onScriptError,"error");return{node:node,id:node&&node.getAttribute("data-requiremodule")}}function intakeDefines(){var args;takeGlobalQueue();while(defQueue.length){args=defQueue.shift();if(args[0]===null){return onError(makeError("mismatch","Mismatched anonymous define() module: "+args[args.length-1]))}else{callGetModule(args)}}context.defQueueMap={}}context={config:config,contextName:contextName,registry:registry,defined:defined,urlFetched:urlFetched,defQueue:defQueue,defQueueMap:{},Module:Module,makeModuleMap:makeModuleMap,nextTick:req.nextTick,onError:onError,configure:function(cfg){if(cfg.baseUrl){if(cfg.baseUrl.charAt(cfg.baseUrl.length-1)!=="/"){cfg.baseUrl+="/"}}var shim=config.shim,objs={paths:true,bundles:true,config:true,map:true};eachProp(cfg,function(value,prop){if(objs[prop]){if(!config[prop]){config[prop]={}}mixin(config[prop],value,true,true)}else{config[prop]=value}});if(cfg.bundles){eachProp(cfg.bundles,function(value,prop){each(value,function(v){if(v!==prop){bundlesMap[v]=prop}})})}if(cfg.shim){eachProp(cfg.shim,function(value,id){if(isArray(value)){value={deps:value}}if((value.exports||value.init)&&!value.exportsFn){value.exportsFn=context.makeShimExports(value)}shim[id]=value});config.shim=shim}if(cfg.packages){each(cfg.packages,function(pkgObj){var location,name;pkgObj=typeof pkgObj==="string"?{name:pkgObj}:pkgObj;name=pkgObj.name;location=pkgObj.location;if(location){config.paths[name]=pkgObj.location}config.pkgs[name]=pkgObj.name+"/"+(pkgObj.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")})}eachProp(registry,function(mod,id){if(!mod.inited&&!mod.map.unnormalized){mod.map=makeModuleMap(id,null,true)}});if(cfg.deps||cfg.callback){context.require(cfg.deps||[],cfg.callback)}},makeShimExports:function(value){function fn(){var ret;if(value.init){ret=value.init.apply(global,arguments)}return ret||value.exports&&getGlobal(value.exports)}return fn},makeRequire:function(relMap,options){options=options||{};function localRequire(deps,callback,errback){var id,map,requireMod;if(options.enableBuildCallback&&callback&&isFunction(callback)){callback.__requireJsBuild=true}if(typeof deps==="string"){if(isFunction(callback)){return onError(makeError("requireargs","Invalid require call"),errback)}if(relMap&&hasProp(handlers,deps)){return handlers[deps](registry[relMap.id])}if(req.get){return req.get(context,deps,relMap,localRequire)}map=makeModuleMap(deps,relMap,false,true);id=map.id;if(!hasProp(defined,id)){return onError(makeError("notloaded",'Module name "'+id+'" has not been loaded yet for context: '+contextName+(relMap?"":". Use require([])")))}return defined[id]}intakeDefines();context.nextTick(function(){intakeDefines();requireMod=getModule(makeModuleMap(null,relMap));requireMod.skipMap=options.skipMap;requireMod.init(deps,callback,errback,{enabled:true});checkLoaded()});return localRequire}mixin(localRequire,{isBrowser:isBrowser,toUrl:function(moduleNamePlusExt){var ext,index=moduleNamePlusExt.lastIndexOf("."),segment=moduleNamePlusExt.split("/")[0],isRelative=segment==="."||segment==="..";if(index!==-1&&(!isRelative||index>1)){ext=moduleNamePlusExt.substring(index,moduleNamePlusExt.length);moduleNamePlusExt=moduleNamePlusExt.substring(0,index)}return context.nameToUrl(normalize(moduleNamePlusExt,relMap&&relMap.id,true),ext,true)},defined:function(id){return hasProp(defined,makeModuleMap(id,relMap,false,true).id)},specified:function(id){id=makeModuleMap(id,relMap,false,true).id;return hasProp(defined,id)||hasProp(registry,id)}});if(!relMap){localRequire.undef=function(id){takeGlobalQueue();var map=makeModuleMap(id,relMap,true),mod=getOwn(registry,id);mod.undefed=true;removeScript(id);delete defined[id];delete urlFetched[map.url];delete undefEvents[id];eachReverse(defQueue,function(args,i){if(args[0]===id){defQueue.splice(i,1)}});delete context.defQueueMap[id];if(mod){if(mod.events.defined){undefEvents[id]=mod.events}cleanRegistry(id)}}}return localRequire},enable:function(depMap){var mod=getOwn(registry,depMap.id);if(mod){getModule(depMap).enable()}},completeLoad:function(moduleName){var found,args,mod,shim=getOwn(config.shim,moduleName)||{},shExports=shim.exports;takeGlobalQueue();while(defQueue.length){args=defQueue.shift();if(args[0]===null){args[0]=moduleName;if(found){break}found=true}else if(args[0]===moduleName){found=true}callGetModule(args)}context.defQueueMap={};mod=getOwn(registry,moduleName);if(!found&&!hasProp(defined,moduleName)&&mod&&!mod.inited){if(config.enforceDefine&&(!shExports||!getGlobal(shExports))){if(hasPathFallback(moduleName)){return}else{return onError(makeError("nodefine","No define call for "+moduleName,null,[moduleName]))}}else{callGetModule([moduleName,shim.deps||[],shim.exportsFn])}}checkLoaded()},nameToUrl:function(moduleName,ext,skipExt){var paths,syms,i,parentModule,url,parentPath,bundleId,pkgMain=getOwn(config.pkgs,moduleName);if(pkgMain){moduleName=pkgMain}bundleId=getOwn(bundlesMap,moduleName);if(bundleId){return context.nameToUrl(bundleId,ext,skipExt)}if(req.jsExtRegExp.test(moduleName)){url=moduleName+(ext||"")}else{paths=config.paths;syms=moduleName.split("/");for(i=syms.length;i>0;i-=1){parentModule=syms.slice(0,i).join("/");parentPath=getOwn(paths,parentModule);if(parentPath){if(isArray(parentPath)){parentPath=parentPath[0]}syms.splice(0,i,parentPath);break}}url=syms.join("/");url+=ext||(/^data\:|\?/.test(url)||skipExt?"":".js");url=(url.charAt(0)==="/"||url.match(/^[\w\+\.\-]+:/)?"":config.baseUrl)+url}return config.urlArgs?url+((url.indexOf("?")===-1?"?":"&")+config.urlArgs):url},load:function(id,url){req.load(context,id,url)},execCb:function(name,callback,args,exports){return callback.apply(exports,args)},onScriptLoad:function(evt){if(evt.type==="load"||readyRegExp.test((evt.currentTarget||evt.srcElement).readyState)){interactiveScript=null;var data=getScriptData(evt);context.completeLoad(data.id)}},onScriptError:function(evt){var data=getScriptData(evt);if(!hasPathFallback(data.id)){return onError(makeError("scripterror","Script error for: "+data.id,evt,[data.id]))}}};context.require=context.makeRequire();return context}req=requirejs=function(deps,callback,errback,optional){var context,config,contextName=defContextName;if(!isArray(deps)&&typeof deps!=="string"){config=deps;if(isArray(callback)){deps=callback;callback=errback;errback=optional}else{deps=[]}}if(config&&config.context){contextName=config.context}context=getOwn(contexts,contextName);if(!context){context=contexts[contextName]=req.s.newContext(contextName)}if(config){context.configure(config)}return context.require(deps,callback,errback)};req.config=function(config){return req(config)};req.nextTick=typeof setTimeout!=="undefined"?function(fn){setTimeout(fn,4)}:function(fn){fn()};if(!require){require=req}req.version=version;req.jsExtRegExp=/^\/|:|\?|\.js$/;req.isBrowser=isBrowser;s=req.s={contexts:contexts,newContext:newContext};req({});each(["toUrl","undef","defined","specified"],function(prop){req[prop]=function(){var ctx=contexts[defContextName];return ctx.require[prop].apply(ctx,arguments)}});if(isBrowser){head=s.head=document.getElementsByTagName("head")[0];baseElement=document.getElementsByTagName("base")[0];if(baseElement){head=s.head=baseElement.parentNode}}req.onError=defaultOnError;req.createNode=function(config,moduleName,url){var node=config.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");node.type=config.scriptType||"text/javascript";node.charset="utf-8";node.async=true;return node};req.load=function(context,moduleName,url){var config=context&&context.config||{},node;if(isBrowser){node=req.createNode(config,moduleName,url);if(config.onNodeCreated){config.onNodeCreated(node,config,moduleName,url)}node.setAttribute("data-requirecontext",context.contextName);node.setAttribute("data-requiremodule",moduleName);if(node.attachEvent&&!(node.attachEvent.toString&&node.attachEvent.toString().indexOf("[native code")<0)&&!isOpera){useInteractive=true;node.attachEvent("onreadystatechange",context.onScriptLoad)}else{node.addEventListener("load",context.onScriptLoad,false);node.addEventListener("error",context.onScriptError,false)}node.src=url;currentlyAddingScript=node;if(baseElement){head.insertBefore(node,baseElement)}else{head.appendChild(node)}currentlyAddingScript=null;return node}else if(isWebWorker){try{importScripts(url);context.completeLoad(moduleName)}catch(e){context.onError(makeError("importscripts","importScripts failed for "+moduleName+" at "+url,e,[moduleName]))}}};function getInteractiveScript(){if(interactiveScript&&interactiveScript.readyState==="interactive"){return interactiveScript}eachReverse(scripts(),function(script){if(script.readyState==="interactive"){return interactiveScript=script}});return interactiveScript}if(isBrowser&&!cfg.skipDataMain){eachReverse(scripts(),function(script){if(!head){head=script.parentNode}dataMain=script.getAttribute("data-main");if(dataMain){mainScript=dataMain;if(!cfg.baseUrl){src=mainScript.split("/");mainScript=src.pop();subPath=src.length?src.join("/")+"/":"./";cfg.baseUrl=subPath}mainScript=mainScript.replace(jsSuffixRegExp,"");if(req.jsExtRegExp.test(mainScript)){mainScript=dataMain}cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript];return true}})}define=function(name,deps,callback){var node,context;if(typeof name!=="string"){callback=deps;deps=name;name=null}if(!isArray(deps)){callback=deps;deps=null}if(!deps&&isFunction(callback)){deps=[];if(callback.length){callback.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(match,dep){deps.push(dep)});deps=(callback.length===1?["require"]:["require","exports","module"]).concat(deps)}}if(useInteractive){node=currentlyAddingScript||getInteractiveScript();if(node){if(!name){name=node.getAttribute("data-requiremodule")}context=contexts[node.getAttribute("data-requirecontext")]}}if(context){context.defQueue.push([name,deps,callback]);context.defQueueMap[name]=true}else{globalDefQueue.push([name,deps,callback])}};define.amd={jQuery:true};req.exec=function(text){return eval(text)};req(cfg)})(window);this.require=require;this.define=define;this.dependencies=[]}Required.add("setConf",function(conf){"use strict";this.require.config(_.extend({baseUrl:setting.app_path,paths:{system:setting.system_path}},conf||{},true))});Required.add("getRequire",function(){"use strict";return this.require});Required.add("getDefine",function(){"use strict";return this.define});Required.add("lookup",function(dependencies){"use strict";var _self=this;_self.dependencies=dependencies;return new Promise(function(resolve,reject){_self.require(_self,dependencies,function(){resolve(_self)})})});Required.add("getDependencies",function(){return this.dependencies});Required.add("getCleanDependencies",function(){var _res=this.dependencies;_.each(_res,function(v,i){_res[i]=_.replace(v.split("/").pop(),/\.(.*)/,_.emptyStr)});return _res});window.Require=new Required;Require.setConf()})(window);"use strict";(function(window){function Http(){this.xhr=new window.XMLHttpRequest||new window.ActiveXObject("Microsoft.XMLHTTP");this.xhr_list=[];this.upload=null;this.config=null;this.interceptors={}}Http.add("request",function(url,data){var _self=this,_query=_.emptyStr,_data=data||null;_self.config={method:"GET",timeout:4e3,upload:false,cors:false,headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"}};_self._handleInterceptor("request",_self.config);return new Promise(function(resolve,reject){if(!_.isSet(url))_.error(_.WARNING_SYRUP.ERROR.NOURL,"(Http .request)");if(!_.isFormData(_data)&&_.isObject(_data)&&_.getObjectSize(_data)>0){_data=_.jsonToQueryString(_data)}if(_self.config.method==="GET"&&_.isString(_data)){_query+="?"+_data}_query=url+_query;_self.xhr.open(_self.config.method,_query,true);_self.xhr.timeout=_self.config.timeout;if(!_.isFormData(_data)){_.each(_self.config.headers,function(value,header){_self._requestHeader(header,value)})}_self.xhr.withCredentials=!!_self.config.cors;if(_.isSet(_self.config.upload)&&_.isBoolean(_self.config.upload)){_self.upload=_self.xhr.upload;_self.xhr=_self.upload}_self.xhr.addEventListener("load",function(e){if(this.status>=200&&this.status<400){var _response=this.response||this.responseText;if(_.isJson(_response)){_response=JSON.parse(_response)}_self._handleInterceptor("success",_response);resolve(_response)}});_self.xhr.addEventListener("progress",function(e){_self._handleInterceptor("progress",e)},false);_self.xhr.addEventListener("readystatechange",function(e){if(this.readyState){_self._handleInterceptor("state",e)}});_self.xhr.addEventListener("abort",function(e){_self._handleInterceptor("abort",e)});_self.xhr.addEventListener("loadend",function(e){_self._handleInterceptor("complete",e)});_self.xhr.addEventListener("loadstart",function(e){_self._handleInterceptor("before",e)});_self.xhr.addEventListener("error",function(e){reject(e);_self._handleInterceptor("error",e)});_self.xhr_list.push(_self.xhr);_self.xhr.send(_self.config.method!=="GET"?_data:null)})});Http.add("intercept",function(interceptors){if(_.isObject(interceptors))MiddleWare.intercept(this,interceptors);return this});Http.add("_handleInterceptor",function(type,param){MiddleWare.trigger(MiddleWare.getInterceptors(this,type),[param,this]);MiddleWare.cleanInterceptor(this,type)});Http.add("get",function(url,data){this.kill();return this.request(url,data)});Http.add("post",function(url,data){MiddleWare.intercept(this,{request:function(config,xhr){config.method="POST"}});this.kill();return this.request(url,data)});Http.add("put",function(url,data){MiddleWare.intercept(this,{request:function(config,xhr){config.method="PUT"}});this.kill();return this.request(url,data)});Http.add("delete",function(url,data){MiddleWare.intercept(this,{request:function(config,xhr){config.method="DELETE"}});this.kill();return this.request(url,data)});Http.add("_requestHeader",function(header,type){this.xhr.setRequestHeader(header,type);return this});Http.add("kill",function(){_.each(this.xhr_list,function(xhr){xhr.abort()});this.xhr_list.length=0;return this});window.Http=Http})(window);"use strict";(function(window){function Repo(){}Repo.add("set",function(key,data){localStorage.setItem(key,JSON.stringify(data))});Repo.add("get",function(key){return _.isJson(localStorage.getItem(key))?JSON.parse(localStorage.getItem(key)):null});Repo.add("append",function(key,element){var _existent=this.get(key),_new=_.extend(_.isSet(_existent)?_existent:{},element);this.set(key,_new,false);return this});Repo.add("destroy",function(){localStorage.clear()});Repo.add("clear",function(key){localStorage.removeItem(key);return this});Repo.add("count",function(){return localStorage.length;

});window.Repo=Repo})(window);"use strict";(function(window){function Workers(){this.Worker=null;this.interceptors={}}Workers.add("run",function(url){var self=this;return new Promise(function(resolve,reject){self.Worker=new Worker(setting.system_path+url+".min.js");self.Worker.addEventListener("message",function(e){self._handleInterceptor("message",e)},false);resolve(self)})});Workers.add("get",function(){return this.Worker});Workers.add("intercept",function(interceptors){if(_.isObject(interceptors))MiddleWare.intercept(this,interceptors);return this});Workers.add("_handleInterceptor",function(type,param){MiddleWare.trigger(MiddleWare.getInterceptors(this,type),[param,this]);MiddleWare.cleanInterceptor(this,type)});Workers.add("toWork",function(message){this.Worker.postMessage(message||null);return this});Workers.add("kill",function(){if(_.isSet(this.Worker)){this.Worker.terminate();this.Worker=null}return this});window.Workers=Workers})(window);(function(window){"use strict";function View(){this.Http=new Http;this.Repo=new Repo;this.key="___templates";this.tpl=null}View.add("lookup",function(template){this.Http.intercept({request:function(config){config.headers["Content-Type"]="text/plain"}});return this.Http.request(setting.app_path+"/templates/"+template)});View.add("seekTpl",function(template){var _self=this,_repo=_self.Repo,_template=null,_save={};if(!_.isSet(_repo.get(_self.key))){_repo.set(_self.key,{})}_template=_repo.get(_self.key);return new Promise(function(resolve,reject){if(template in _template){_self.tpl=_template[template];resolve(_self)}else{_self.lookup(template).then(function(_tpl){_self.tpl=_save[template]=_tpl;_repo.append(_self.key,_save);resolve(_self)}).catch(function(){reject(template);_.error(_.WARNING_SYRUP.ERROR.NONETWORK,"(View .seekTpl)")})}})});View.add("getTpl",function(){return this.tpl});View.add("clear",function(){this.Repo.clear(this.key);return this});View.add("cleanCache",function(template){var old_templates=this.Repo.get(this.key);if(old_templates&&template in old_templates){delete old_templates[template]}this.Repo.set(this.key,old_templates);return this});View.add("render",function(_template,_fields){var _self=this,_worker=new Workers;return new Promise(function(resolve){_fields=_.isObject(_template)&&_template||_fields;_template=!_.isObject(_template)&&_.isString(_template)&&_template||_self.tpl;_worker.intercept({message:function(e){resolve(e.data)}}).run("/workers/setting/Parser").then(function(worker){worker.toWork({template:_template||_.emptyStr,fields:_fields||{}})})})});window.View=View})(window);"use strict";(function(window){var WARNING_MODEL={ERROR:{NOPACK:"Error packing model",OBJECTNEEDED:"Object need to set in model"}};function Model(){this.data=null;this.blob=null;this.scope={};this.type="POST";this.model=null;this.failed=null}Model.add("method",function(method){this.type=method.toUpperCase();return this});Model.add("attach",function(name,attach){var self=this;_.assert(self.data,WARNING_MODEL.ERROR.NOPACK,"(Model .attach)");self.data.append(name,attach);return this});Model.add("multiple",function(name){var _return=[],_model_obj=this.model.get(0);if(name in _model_obj.elements){_.each(_model_obj.elements[name],function(v,i){_return.push(v.value)})}return _return.length>0?_return:false});Model.add("fail",function(field,error){this.failed=true;return{field:field,error:error,coords:_.cartesianPlane(field)}});Model.add("getScope",function(){return this.scope});Model.add("getData",function(){return this.data});Model.add("getBinaries",function(){return this.blob});Model.add("file",function(input){var _self=this,_formData=new FormData,_files=[],_field=!_.is$(input)&&_$(input).get(0)||input;return new Promise(function(resolve,reject){if(_field.type==="file"&&_.isSet(_field.name)){var _temp=_field.files,x=_temp.length;while(x--){_files[x]=_temp[x];_formData.append(_field.name,_temp[x])}}_self.scope["_files"]=_files;_self.blob=_formData;resolve(_self)})});Model.add("binary",function(model){var _self=this;_self.model=!_.is$(model)&&_$(model)||model;return new Promise(function(resolve,reject){_self.model.find('input[type="file"]',function(field){_self.file(field.get(0)).then(resolve)})})});Model.add("set",function(model,object){if(!_.isObject(object))_.error(WARNING_MODEL.ERROR.OBJECTNEEDED,"(Model .set)");var _self=this;_self.model=!_.is$(model)&&_$(model)||model;_.each(object,function(v,i){_self.model.find("input[name="+i+"]",function(e){_self.scope[i]=v;e.val(v)})})});Model.add("get",function(model){this.model=!_.is$(model)&&_$(model)||model;var _self=this,_modelData=new FormData,_field_array,_model_obj=_self.model.get(0),_fields=_model_obj.querySelectorAll("input, textarea, select"),x=_fields.length;_self.failed=false;return new Promise(function(resolve,reject){while(x--){if(!_fields[x])continue;if(_fields[x].type==="file"){_self.file(_fields[x]);continue}if(_fields[x].type==="checkbox"||_fields[x].type==="radio"){if(!_fields[x].checked){continue}}var field=_fields[x],fieldValue=field.value;if(!_$(field).data("skip")&&_.isEmpty(fieldValue)){reject(_self.fail(field,"empty"));break}else if(_$(field).data("mail")&&!_.isMail(fieldValue)){reject(_self.fail(field,"invalid_mail"));break}else if(_$(field).data("min")&&+_$(field).data("min")>fieldValue.length){reject(_self.fail(field,"minim_chars"));break}else if(_$(field).data("max")&&+_$(field).data("max")<fieldValue.length){reject(_self.fail(field,"overflow_chars"));break}else{if(_$(field).data("custom")){var Regex=new RegExp(_$(field).data("custom"),"g");if(!Regex.test(fieldValue)){reject(_self.fail(field,"invalid_custom"));break}}if(_.isSet(field.name)){if(!!(_field_array=_self.multiple(field.name)))fieldValue=_field_array;_modelData.append(field.name,fieldValue);_self.scope[field.name]=fieldValue}}}_self.data=_modelData;resolve(_self)})});window.Model=Model})(window);"use strict";(function(window){function Apps(){this.root=null;this.lib=null;this.scope=null;this.lazy=false;this.interceptors={};this.interceptClean=true;this.moduleCollection={};this.appCollection={};this.recipeCollection={};this.onchange={}}Apps.add("module",function(name,dependencies){if(!(name in this.moduleCollection)){this.moduleCollection[name]=new Apps;this.moduleCollection[name].root=name;this.moduleCollection[name].moduled=true;this.moduleCollection[name].lib=new LibClass;this.moduleCollection[name].lib.blend(name,dependencies)}return this.moduleCollection[name]});Apps.add("blend",function(name,dependencies){var _self=new Apps;_self.lib=new LibClass;_self.root=name;_self.parent=this.moduled&&this||null;_self.lazy=this.lazy;_self.scope={};_self.blended=true;if(this.moduled){dependencies=dependencies||[];dependencies.push(this.root);this.appCollection[name]=_self}_self.lib.blend(name,dependencies);return _self});Apps.add("recipe",function(moduleId,module){if(this.root&&this.blended){if(_.isSet(module)){var _self=this;_self.recipeCollection[moduleId]={creator:module,instance:null};if(!this.lazy)_$(function(){_self._taste(moduleId)})}}return this});Apps.add("_watch",function(moduleId){var _self=this;Object.observe(_self.scope,function(change){_.each(change,function(v){if(v.name in _self.onchange&&_.getObjectSize(v.object)>0&&moduleId===v.name){_self.onchange[v.name].call(_self.recipeCollection[moduleId].instance,{name:v.name,old:v.oldValue,type:v.type,object:v.object[v.name]});return false}})})});Apps.add("_add",function(moduleId){if(!_.isObject(this.scope[moduleId])){this.scope[moduleId]={}}});Apps.add("_trigger",function(moduleId){if(moduleId in this.recipeCollection)return this.recipeCollection[moduleId].creator(_,this.scope);return{}});Apps.add("cook",function(callback){if(_.isFunction(callback))callback.call(this,this.lib.get(this.root),_);return this});Apps.add("spice",function(object){if(_.isObject(object))this.lib.make(object);return this});Apps.add("service",function(object){this.lib.supply(object);return this});Apps.add("_getRecipe",function(moduleId){if(moduleId in this.recipeCollection&&_.isSet(this.root))return this.recipeCollection[moduleId].instance;return null});Apps.add("_setScope",function(moduleId,object){if(moduleId in this.scope){this.scope[moduleId]=object}return this});Apps.add("_getScope",function(moduleId){if(moduleId in this.scope){return this.scope[moduleId]}return{}});Apps.add("when",function(event,name){var self=this;return event&&({change:{then:function(resolve){self.onchange[name]=resolve}}}[event]||{then:function(){}})});Apps.add("_bindListener",function(moduleId){var enabled_events=["click","submit","change","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseout","mouseup","keydown","keypress","keyup","blur","focus","input","select","reset"],_self=this,_recipe=this.recipeCollection[moduleId].instance,_mod=_$('[sp-recipe="'+moduleId+'"]');if(_mod.exist){_.each(enabled_events,function(v){_mod.listen(v,function(e){var _event="sp-"+e.type,_attr=e.target.getAttribute(_event);if(_attr){if(_attr in _recipe&&_.isFunction(_recipe[_attr])){e.preventDefault();_recipe[_attr](_self.lib.get(_recipe.parent),e)}}})})}});Apps.add("_models",function(moduleId){var _self=this,_model=new Model,_resource=_$('[sp-recipe="'+moduleId+'"] [sp-model]');if(_resource.exist){_self.recipeCollection[moduleId].instance.model={object:_model,resource:_resource,set:function(obj){_model.set(_resource,obj);return _self.recipeCollection[moduleId].instance},get:function(item){return{then:function(resolve){return _model.get(_resource).then(function(e){if(_.isSet(item)&&_.isArray(item)&&!_.isEmpty(item)){var _result={};_.each(item,function(v,i){if(v in e.scope)_result[v]=e.scope[v]});e.scope=_result}resolve.call(_self.recipeCollection[moduleId].instance,e)})}}}}}});Apps.add("_views",function(moduleId){var _self=this;_self.recipeCollection[moduleId].instance.view={render:function(_view,_cache){_self._serve(moduleId,_view||null,_cache||false);return _self.recipeCollection[moduleId].instance}}});Apps.add("_scopes",function(moduleId){var _self=this;_self.recipeCollection[moduleId].instance.scope={global:_self.scope,object:_self.scope[moduleId],set:function(nModule,object){var _moduleId=!_.isObject(nModule)&&_.isString(nModule)&&nModule||moduleId,_object=_.isObject(nModule)&&nModule||object;if(_.isObject(_object)){_self._setScope(_moduleId,_object);return _self.recipeCollection[moduleId].instance}},get:function(nModule){var _moduleId=_.isString(nModule)?nModule:moduleId;return _self._getScope(_moduleId)}}});Apps.add("_app",function(moduleId){var _self=this;_self.recipeCollection[moduleId].instance.app={object:_$("[sp-app]"),title:function(title){var _title=_$("title");if(_title.exist){_title.text(title)}return _self.recipeCollection[moduleId].instance}}});Apps.add("_recipes",function(moduleId){var _self=this;_self.recipeCollection[moduleId].instance.recipe={$:_$('[sp-recipe="'+moduleId+'"]'),get:function(nModule){var _moduleId=_.isString(nModule)?nModule:moduleId;return _self._getRecipe(_moduleId)},drop:function(nModule){var _moduleId=_.isString(nModule)?nModule:moduleId;_self.drop(_moduleId);return _self.recipeCollection[moduleId].instance}}});Apps.add("_serve",function(moduleId,view,cleanCache){var _view=null,_scope=this.scope[moduleId];var _dom=_$('[sp-recipe="'+moduleId+'"] [sp-view]'),_dom_template=_$('[sp-recipe="'+moduleId+'"] [sp-tpl]');if(_dom.exist){_view=new View;if(_.isSet(view)&&_.isString(view)){var view_name=view.split("/").pop(),view_dir=_.replace(view,"/"+view_name,_.emptyStr),view_template_dir="layout/"+view_dir+"/"+view_name;if(/\.html$/.test(view_name)){if(cleanCache)_view.cleanCache(view_template_dir);_view.seekTpl(view_template_dir).then(function(view){view.render(_scope).then(function(res){_dom.html(res)})})}else{Require.lookup(["view/"+view_dir]).then(function(){if(view_name in _view.__proto__)_view[view_name](_,_scope,function(my_html){_dom.html(my_html)})})}}else if(_dom_template.exist){_view.render(_dom_template.html(),_scope).then(function(result){_dom.html(result)})}}return this});Apps.add("_taste",function(moduleId){var _self=this;_self._handleInterceptor("taste",_self);if(moduleId in _self.recipeCollection&&_.isSet(_self.root)){_self._add(moduleId);_self.recipeCollection[moduleId].instance=_self._trigger(moduleId);if(!_.isObject(_self.recipeCollection[moduleId].instance))return;_self.recipeCollection[moduleId].instance.name=moduleId;_self.recipeCollection[moduleId].instance.parent=_self;_self.recipeCollection[moduleId].instance.when=function(event){return _self.when(event,moduleId)};_self._recipes(moduleId);_self._scopes(moduleId);_self._models(moduleId);_self._app(moduleId);_self._views(moduleId);if("init"in _self.recipeCollection[moduleId].instance&&_.isFunction(_self.recipeCollection[moduleId].instance.init)){_self._handleInterceptor("init",_self.recipeCollection[moduleId].instance);if("require"in _self.recipeCollection[moduleId].instance&&_.isArray(_self.recipeCollection[moduleId].instance.require)){Require.lookup(_self.recipeCollection[moduleId].instance.require).then(function(e){_self.lib._dependencies(e.getCleanDependencies());_self.recipeCollection[moduleId].instance.init(_self.lib.get(_self.root))})}else{_self.recipeCollection[moduleId].instance.init(_self.lib.get(_self.root))}_self._handleInterceptor("after",_self.recipeCollection[moduleId].instance)}_self._bindListener(moduleId);_self._watch(moduleId)}return this});Apps.add("taste",function(moduleId){var _self=this,_moduleId=moduleId&&[moduleId]||_.getObjectKeys(_self.recipeCollection);_self.lazy=false;_self.interceptClean=false;_.each(_moduleId,function(v){_self._taste(v)});MiddleWare.cleanInterceptor(_self,"init");return this});Apps.add("intercept",function(interceptors){if(_.isObject(interceptors))MiddleWare.intercept(this,interceptors);return this});Apps.add("_handleInterceptor",function(type,param){MiddleWare.trigger(MiddleWare.getInterceptors(this,type),[param,this]);if(this.interceptClean){MiddleWare.cleanInterceptor(this,type)}});Apps.add("drop",function(moduleId){if(moduleId in this.recipeCollection){if(this.recipeCollection[moduleId].instance){if("destroy"in this.recipeCollection[moduleId].instance)this.recipeCollection[moduleId].instance.destroy(this.lib.get(this.root));this.recipeCollection[moduleId]=null}}return this});Apps.add("dropAll",function(){var _self=this;_.each(this.recipeCollection,function(module,id){_self.drop(id)});return this});window.App=new Apps;window.AppClass=Apps})(window);(function(window){var WARNING_ROUTE={ERROR:{BADINSTANCE:"App instance needed"}};"use strict";function Router(){this.routes={};this.history=window.history;this.cleanParam=/([\w]+:)/g;this.findParams=/([\w]+:[\w\[\]\-\+\(\)]+)/g;this.onpopstate={};this.interceptors={};this.module=null;this.default=true;var _self=this;window.addEventListener("popstate",function(e){_self._handleInterceptor("popstate",e);if(_.isSet(e.state)&&"route_name"in e.state){if(e.state.route_name in _self.onpopstate){_.each(_self.onpopstate[e.state.route_name],function(v,i){v(e.state,e);_self._handleInterceptor("redirect",e)},true)}}})}Router.add("connect",function(to_route){if(!(to_route instanceof AppClass))_.error(WARNING_ROUTE.ERROR.BADINSTANCE,"(Router .route)");this.module=to_route;to_route.lazy=true;return this});Router.add("set",function(routes){var _self=this;return new Promise(function(resolve,reject){_self.routes=_.extend(_self.routes,routes);resolve(_self)})});Router.add("when",function(route_name,conf){_.assert(route_name,_.WARNING_SYRUP.ERROR.NOPARAM,"(Router .when)");var _self=this,_router;if(!(conf&&"app"in conf)||!(route_name in _self.routes))return _self;if(!(route_name in _self.onpopstate))_self.onpopstate[route_name]=[];_self.onpopstate[route_name].push(function(state,e){_self._handleSkull(conf,function(){if(conf.app in _self.module.appCollection){_self.module.appCollection[conf.app].intercept({init:function(mod){mod.uri={params:state,route:_self.routes[route_name]}}});_self.module.appCollection[conf.app].taste()}},[state,e])});if(_self.default&&(_router=_self._route(route_name))){_self.default=false;_self.redirect(route_name,_router.query,_router)}return _self});Router.add("redirect",function(route_name,params,config){_.assert(route_name,_.WARNING_SYRUP.ERROR.NOPARAM,"(Router .redirect)");var _self=this,_the_route=null,_the_new_route=null,_params=null,_config={trigger:true};return new Promise(function(resolve,reject){if(!(route_name in _self.routes)){reject(route_name);return}_params=_.isObject(params)&&params||{};_config=_.extend(_config,config||{},true);_the_new_route=_the_route=_self.routes[route_name];_the_new_route="uri"in _config&&_config.uri||_self._rewriteRules(_the_new_route,_params)||_the_new_route;_params=_.getObjectSize(_params)>0&&_params||_self._reverseUriParams(_config.uri||_the_new_route,_the_route,"route"in _config&&_config.route)||{};_self._triggerPopState(_.extend(_params,{route_name:route_name}),route_name,_the_new_route,_config);resolve(_the_new_route)})});Router.add("otherwise",function(route_name,conf){if(_.isString(route_name)&&route_name in this.routes&&this.default){this.when(route_name,conf);this.redirect(route_name,{})}return this});Router.add("reverse",function(route_name,params){if(route_name in this.routes)return this._rewriteRules(this.routes[route_name],params);return _.emptyStr});Router.add("intercept",function(interceptors){if(_.isObject(interceptors))MiddleWare.intercept(this,interceptors);return this});Router.add("_route",function(route_name){var _the_route=this.routes[route_name],_query_params=_.queryStringToJson(location.search),_uri_path=this._rewriteRules(_the_route,_query_params)||location.pathname,_uri_path_slash_index=_.oChars(_uri_path,"/"),_the_route_slash_index=_.oChars(_the_route,"/");_the_route=this._cleanedUriParams(_the_route);if(_uri_path_slash_index>_the_route_slash_index){_uri_path=_.truncateString(_uri_path,-1)}else if(_the_route_slash_index>_uri_path_slash_index){_uri_path+="/"}return this._matchUri(_the_route,_uri_path)?{uri:_uri_path,route:_the_route,query:_query_params,match:true}:false});Router.add("_handleSkull",function(conf,callback,params){var _view=new View;if(!conf.cache)_view.cleanCache(conf.tpl);_view.seekTpl(conf.tpl).then(function(view){var _main=_$("[sp-app]");if(_main.exist)_main.html(view.getTpl());callback.apply(conf.app,params)})});Router.add("_handleInterceptor",function(type,param){MiddleWare.trigger(MiddleWare.getInterceptors(this,type),[param,this]);MiddleWare.cleanInterceptor(this,type)});Router.add("_matchUri",function(_the_route,_uri_path){return _.toRegExp("^"+_the_route+"$").test(_uri_path)});Router.add("_cleanedUriParams",function(_the_route){return _.replace(_the_route,this.cleanParam,_.emptyStr)});Router.add("_reverseUriParams",function(_the_uri,_the_route,clean_route){var _match=_.replaceInArray(":",_.emptyStr,_the_route.match(this.cleanParam)),_route=clean_route||this._cleanedUriParams(_the_route);return _match&&_.toObject(_match,_.compactArray(_the_uri.split(_.toRegExp(_route))))||{}});Router.add("_rewriteRules",function(_the_new_route,_params){var _findParams=this.findParams,_get_groups=_.getObjectSize(_params)>0&&_.getRegExpGroup(_the_new_route,_findParams,_.getObjectKeys(_params));return _get_groups&&_.replace(_the_new_route,_findParams,_.toObject(_.getObjectValues(_get_groups),_.getObjectValues(_params)))||false});Router.add("_triggerPopState",function(_params,route_name,_the_new_route,_config){if(_config.trigger){this.history.replaceState(_params,route_name,_the_new_route);this.history.pushState(_params,route_name,_the_new_route);this.history.back()}});window.Router=new Router;window.RouterClass=Router})(window);(function(window){"use strict";function Hash(){this.interceptors={};this.onhashchange={};var _self=this;window.addEventListener("hashchange",function(e){_self._handleInterceptor("change",e);var _hash=_self._cleanHash(location.hash),_params=_self._getParams(location.hash);if(_hash in _self.onhashchange){_.each(_self.onhashchange[_hash],function(v){v(_params)},true)}})}Hash.add("when",function(hash){_.assert(hash,_.WARNING_SYRUP.ERROR.NOPARAM,"(Router .when)");var _self=this;if(!(hash in _self.onhashchange))_self.onhashchange[hash]=[];return{then:function(resolve){_self.onhashchange[hash].push(resolve);return _self}}});Hash.add("_cleanHash",function(hash){var _hash=_.replace(hash,"#",_.emptyStr),_split=_hash.split("/");return(_split.length>1&&_split||_hash.split("?"))[0]});Hash.add("_getParams",function(hash){var _split=hash.split("/");_split=(_split.length>1&&_split||hash.split("?")).splice(1);return _split.length>0&&_.queryStringToJson(_split[0])||{}});Hash.add("intercept",function(interceptors){if(_.isObject(interceptors))MiddleWare.intercept(this,interceptors);return this});Hash.add("_handleInterceptor",function(type,param){MiddleWare.trigger(MiddleWare.getInterceptors(this,type),[param,this]);MiddleWare.cleanInterceptor(this,type)});Hash.add("connect",function(to_route){if(!(to_route instanceof AppClass))_.error(WARNING_ROUTE.ERROR.BADINSTANCE,"(Router .route)");this.module=to_route;to_route.lazy=true;return this});window.Hash=Hash})(window);