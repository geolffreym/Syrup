<!DOCTYPE html>
<html lang="en" sp-app="Hey">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<script src="/syrup/dist/init.js"></script>


<div sp-recipe="Hey.You">
    <!-- Hey.You recipe -->
</div>


<div sp-recipe="Hey.Do">
    <!-- Hey.Do recipe -->
    <!-- Event callback in recipe Hey.Do -->
    <button sp-click="redirect">Redirect</button>
</div>

<script>

    //The controller
    _$ (function () {

        //The App with dependencies
        var my_App = App.blend ('Hey', ['Http', 'Model', 'Router']);

        //Before execution
        my_App.supply (function (_, $) {
            //Before execution what to do?
            //Initialize the routes
            $.Router.set ({
                'myLocalRoute': '/Routes.html',
                'theNewRoute' : '/route/:page/:user/'
            });

        });


        //RECIPES
        //A new recipe for Hey
        my_App.recipe ('Hey.You', function (_, _$, scope) {
            return {
                init   : function ($) {

                    //When the "theNewRoute" match. What to do?
                    $.Router.when ('theNewRoute').then (function (params, event) {
                        console.log (params.getIndex (':page'));
                        console.log (params.getIndex (':user'));
                    })

                },
                destroy: function ($) {

                    //Dropped? What to do?
                    alert ('destroyed?')
                }
            }
        });

        //A new recipe for Hey
        my_App.recipe ('Hey.Do', function (_, _$, scope) {
            return {
                init    : function ($) {},
                redirect: function (e, $) {

                    //Redirect to "theNewRoute" with params { ':page': '3', ':user':'2' }
                    $.Router.redirect ('theNewRoute', { ':page': '3', ':user': '2' })
                            .then (function () { });
                }
            }
        });

    });

</script>
</body>
</html>
