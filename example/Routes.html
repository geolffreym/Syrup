<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>

<body>

<main sp-app></main>


<script src="/syrup/dist/init.js"></script>
<script>

    //TODO improve using modules
    Router.set ({
        'home' : '/syrup/Routes.html',
        'route': '/route/:page/:user/'

    }).then (function (router) {

        //Router ready
        router.when ('home', {
            'tpl': 'skull/home.html'

        }).then (function (params, skull) {
            //HOME APP
            //The App with dependencies
            var _App = App.blend ('home', ['Http']);

            _App.recipe ('home1', function (_, scope) {
                return {
                    init   : function ($) {

                        this.app.title ('Home');

                        this.scope.set ({
                            'message': 'Hey Man'
                        }).view.render ();

                    },
                    destroy: function ($) {

                        //Dropped? What to do?
                        alert ('destroyed?')
                    }
                }
            }).recipe ('home2', function (_, scope) {
                return {
                    init    : function ($) {},
                    redirect: function ($) {
                        Router.redirect ('route', {
                            ':page': 1,
                            ':user': 2
                        })
                    }
                }
            });

        }).when ('route', {
            tpl: 'skull/route.html'

        }).then (function (params, e) {
            //ROUTE APP
            //The App with dependencies
            App.blend ('route', []).recipe ('router', function (_, scope) {
                return {
                    init    : function ($) {
                        this.app.title ('Router');
                        console.log (params.getIndex (':page'))

                    },
                    redirect: function () {
                        Router.redirect ('home', {});
                    }
                }
            })

        })
    })


</script>
</body>
</html>
