<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<script src="/syrup/dist/init.js"></script>

<main sp-app></main>


<script>

    //Module
    App.module ('main', [
        'Http',
        'Router'

    ]).spice ({
        MAX: 1
    }).cook (function ($) {

        $.Router.handle (this).set ({
            'home' : '/syrup/Modules.html',
            'route': '/route/:page/:user/'
        }).then (function (route) {
            route.when ('home', {
                tpl    : 'skull/home.html',
                app    : 'index',
                default: true

            }).when ('route', {
                tpl: 'skull/route.html',
                app: 'route'
            })
        });


//        $.Router.intercept ({
//            redirect: function (e) {
//                console.log (e)
//            }
//        });

        //Http Interceptors
        $.Http.intercept ({
            'request': function (c) {
                console.log (c)
            }
        });

        //Router
    })


</script>

<script>

    //Index App
    App.module ('main')
            .blend ('index', ['Http'])
            .recipe ('home2', function (_, g) {
        return {
            init    : function ($) {
                console.log ('i am index');
                //console.log ($.Http)
            },
            redirect: function ($) {
                $.main.Router.redirect ('route', {
                    ':page': 1,
                    ':user': 2
                })
            }
        }
    });


    //Route App
    App.module ('main')
            .blend ('route', []).recipe ('router', function (_, g) {
        return {
            init    : function ($) {
                console.log (this.uri);
                //console.log ($.Http)
            },
            redirect: function ($) {
                $.main.Router.redirect ('home', {});
            }
        }
    })


</script>
</body>
</html>