<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<script src="/syrup/dist/init.js"></script>

<main sp-app></main>


<script>

    //Module
    App.module ('main', [
        'Http',
        'Router'

    ]).spice ({
        MAX: 1
    }).cook (function ($) {

        //Provide conf to Router
        $.Router.connect (this).set ({
            'home' : '/syrup/Modules.html',
            'route': '/route/:page/:user/'

        }).then (function (route) {

            route.when ('home', {
                tpl    : 'skull/home.html',
                app    : 'index',
                default: true

            }).when ('route', {
                tpl: 'skull/route.html',
                app: 'route'
            })

        });
    })

</script>

<script>

    (function (App) {
        //Encapsulate

        var _main = App.module ('main'),
                _indexApp = _main.blend ('index', ['Hash']);

        _indexApp.cook (function ($) {

            //Handling Hash..
            $.Hash.when ('route').then (function (e) {
                $.redirect ('route', {
                    ':page': e.getIndex (0),
                    ':user': e.getIndex (1)
                });
            })

        }).service ({
            'redirect': function (route, params) {
                this.main.Router.redirect (route, params);
            }
        });

        //Index App
        _indexApp.recipe ('home1', function () {
            return {
                init: function ($) {

                    //Global Http
                    //console.log ($.main.Http);

                    //Own Http?
                    //console.log ($.Http);

                    this.scope.set ({
                        beatles: [
                            { firstName: 'Pedro', lastName: 'Perez' }
                        ]
                    }).view.render ('Hey/You.html', true);


                }
            }
        }).recipe ('home2', function (_, g) {
            return {}
        });

    }) (App);


    //Route App
    App.module ('main')
            .blend ('route', [])
            .recipe ('router', function (_, g) {
        return {
            init    : function ($) {

                //Get the uri data from router
                console.log (this.uri);
                //console.log ($.Http)
            },
            redirect: function ($) {
                $.main.Router.redirect ('home', {});
            }
        }
    })


</script>
</body>
</html>